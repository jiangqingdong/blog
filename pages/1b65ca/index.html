<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.62" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://mister-hope.github.io/pages/1b65ca/"><meta property="og:site_name" content="å­¦ä¹ ç¬”è®°"><meta property="og:title" content="KafkaåŸºæœ¬åŸç†"><meta property="og:description" content="Kafkaæ˜¯æœ€åˆç”±Linkedinå…¬å¸å¼€å‘ï¼Œæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ã€æ”¯æŒåˆ†åŒºçš„ï¼ˆpartitionï¼‰ã€å¤šå‰¯æœ¬çš„ï¼ˆreplicaï¼‰ï¼ŒåŸºäºzookeeperåè°ƒçš„åˆ†å¸ƒå¼æ¶ˆæ¯ç³»ç»Ÿï¼Œå®ƒçš„æœ€å¤§çš„ç‰¹æ€§å°±æ˜¯å¯ä»¥å®æ—¶çš„å¤„ç†å¤§é‡æ•°æ®ä»¥æ»¡è¶³å„ç§éœ€æ±‚åœºæ™¯ï¼šæ¯”å¦‚åŸºäºhadoopçš„æ‰¹å¤„ç†ç³»ç»Ÿã€ä½å»¶è¿Ÿçš„å®æ—¶ç³»ç»Ÿã€Storm/Sparkæµå¼å¤„ç†å¼•æ“ï¼Œweb/nginxæ—¥å¿—ã€è®¿é—®æ—¥å¿—ï¼Œæ¶ˆæ¯æœåŠ¡ç­‰ç­‰ï¼Œç”¨scalaè¯­è¨€ç¼–å†™ï¼ŒLinkedinäº2010å¹´è´¡çŒ®ç»™äº†ApacheåŸºé‡‘ä¼šå¹¶æˆä¸ºé¡¶çº§å¼€æº é¡¹ç›®ã€‚ Kafkaçš„ä½¿ç”¨åœºæ™¯ æ—¥å¿—æ”¶é›†ï¼šä¸€ä¸ªå…¬å¸å¯ä»¥ç”¨Kafkaæ”¶é›†å„ç§æœåŠ¡çš„logï¼Œé€šè¿‡kafkaä»¥ç»Ÿä¸€æ¥å£æœåŠ¡çš„æ–¹å¼å¼€æ”¾ç»™å„ç§consumerï¼Œä¾‹å¦‚hadoopã€Hbaseã€Solrç­‰ã€‚ æ¶ˆæ¯ç³»ç»Ÿï¼šè§£è€¦å’Œç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ã€ç¼“å­˜æ¶ˆæ¯ç­‰ã€‚ ç”¨æˆ·æ´»åŠ¨è·Ÿè¸ªï¼šKafkaç»å¸¸è¢«ç”¨æ¥è®°å½•webç”¨æˆ·æˆ–è€…appç”¨æˆ·çš„å„ç§æ´»åŠ¨ï¼Œå¦‚æµè§ˆç½‘é¡µã€æœç´¢ã€ç‚¹å‡»ç­‰æ´»åŠ¨ï¼Œè¿™äº›æ´»åŠ¨ä¿¡æ¯è¢«å„ä¸ªæœåŠ¡å™¨å‘å¸ƒåˆ°kafkaçš„topicä¸­ï¼Œç„¶åè®¢é˜…è€…é€šè¿‡è®¢é˜…è¿™äº›topicæ¥åšå®æ—¶çš„ç›‘æ§åˆ†æï¼Œæˆ–è€…è£…è½½åˆ°hadoopã€æ•°æ®ä»“åº“ä¸­åšç¦»çº¿åˆ†æå’ŒæŒ–æ˜ã€‚ è¿è¥æŒ‡æ ‡ï¼šKafkaä¹Ÿç»å¸¸ç”¨æ¥è®°å½•è¿è¥ç›‘æ§æ•°æ®ã€‚åŒ…æ‹¬æ”¶é›†å„ç§åˆ†å¸ƒå¼åº”ç”¨çš„æ•°æ®ï¼Œç”Ÿäº§å„ç§æ“ä½œçš„é›†ä¸­åé¦ˆï¼Œæ¯”å¦‚æŠ¥è­¦å’ŒæŠ¥å‘Šã€‚"><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2023-08-01T18:24:48.000Z"><meta property="article:author" content="æ±Ÿ"><meta property="article:published_time" content="2023-04-02T22:49:56.000Z"><meta property="article:modified_time" content="2023-08-01T18:24:48.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"KafkaåŸºæœ¬åŸç†","image":[""],"datePublished":"2023-04-02T22:49:56.000Z","dateModified":"2023-08-01T18:24:48.000Z","author":[{"@type":"Person","name":"æ±Ÿ"}]}</script><title>KafkaåŸºæœ¬åŸç† | å­¦ä¹ ç¬”è®°</title><meta name="description" content="Kafkaæ˜¯æœ€åˆç”±Linkedinå…¬å¸å¼€å‘ï¼Œæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ã€æ”¯æŒåˆ†åŒºçš„ï¼ˆpartitionï¼‰ã€å¤šå‰¯æœ¬çš„ï¼ˆreplicaï¼‰ï¼ŒåŸºäºzookeeperåè°ƒçš„åˆ†å¸ƒå¼æ¶ˆæ¯ç³»ç»Ÿï¼Œå®ƒçš„æœ€å¤§çš„ç‰¹æ€§å°±æ˜¯å¯ä»¥å®æ—¶çš„å¤„ç†å¤§é‡æ•°æ®ä»¥æ»¡è¶³å„ç§éœ€æ±‚åœºæ™¯ï¼šæ¯”å¦‚åŸºäºhadoopçš„æ‰¹å¤„ç†ç³»ç»Ÿã€ä½å»¶è¿Ÿçš„å®æ—¶ç³»ç»Ÿã€Storm/Sparkæµå¼å¤„ç†å¼•æ“ï¼Œweb/nginxæ—¥å¿—ã€è®¿é—®æ—¥å¿—ï¼Œæ¶ˆæ¯æœåŠ¡ç­‰ç­‰ï¼Œç”¨scalaè¯­è¨€ç¼–å†™ï¼ŒLinkedinäº2010å¹´è´¡çŒ®ç»™äº†ApacheåŸºé‡‘ä¼šå¹¶æˆä¸ºé¡¶çº§å¼€æº é¡¹ç›®ã€‚ Kafkaçš„ä½¿ç”¨åœºæ™¯ æ—¥å¿—æ”¶é›†ï¼šä¸€ä¸ªå…¬å¸å¯ä»¥ç”¨Kafkaæ”¶é›†å„ç§æœåŠ¡çš„logï¼Œé€šè¿‡kafkaä»¥ç»Ÿä¸€æ¥å£æœåŠ¡çš„æ–¹å¼å¼€æ”¾ç»™å„ç§consumerï¼Œä¾‹å¦‚hadoopã€Hbaseã€Solrç­‰ã€‚ æ¶ˆæ¯ç³»ç»Ÿï¼šè§£è€¦å’Œç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ã€ç¼“å­˜æ¶ˆæ¯ç­‰ã€‚ ç”¨æˆ·æ´»åŠ¨è·Ÿè¸ªï¼šKafkaç»å¸¸è¢«ç”¨æ¥è®°å½•webç”¨æˆ·æˆ–è€…appç”¨æˆ·çš„å„ç§æ´»åŠ¨ï¼Œå¦‚æµè§ˆç½‘é¡µã€æœç´¢ã€ç‚¹å‡»ç­‰æ´»åŠ¨ï¼Œè¿™äº›æ´»åŠ¨ä¿¡æ¯è¢«å„ä¸ªæœåŠ¡å™¨å‘å¸ƒåˆ°kafkaçš„topicä¸­ï¼Œç„¶åè®¢é˜…è€…é€šè¿‡è®¢é˜…è¿™äº›topicæ¥åšå®æ—¶çš„ç›‘æ§åˆ†æï¼Œæˆ–è€…è£…è½½åˆ°hadoopã€æ•°æ®ä»“åº“ä¸­åšç¦»çº¿åˆ†æå’ŒæŒ–æ˜ã€‚ è¿è¥æŒ‡æ ‡ï¼šKafkaä¹Ÿç»å¸¸ç”¨æ¥è®°å½•è¿è¥ç›‘æ§æ•°æ®ã€‚åŒ…æ‹¬æ”¶é›†å„ç§åˆ†å¸ƒå¼åº”ç”¨çš„æ•°æ®ï¼Œç”Ÿäº§å„ç§æ“ä½œçš„é›†ä¸­åé¦ˆï¼Œæ¯”å¦‚æŠ¥è­¦å’ŒæŠ¥å‘Šã€‚">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-d225b157.css" as="style"><link rel="stylesheet" href="/assets/style-d225b157.css">
    <link rel="modulepreload" href="/assets/app-c8395efa.js"><link rel="modulepreload" href="/assets/index.html-8129550b.js"><link rel="modulepreload" href="/assets/index.html-225af986.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-c27b6911.js"><link rel="prefetch" href="/assets/intro.html-d050d194.js" as="script"><link rel="prefetch" href="/assets/index.html-3841b971.js" as="script"><link rel="prefetch" href="/assets/slides.html-4bcf9c90.js" as="script"><link rel="prefetch" href="/assets/index.html-9da1f986.js" as="script"><link rel="prefetch" href="/assets/index.html-06aa5afc.js" as="script"><link rel="prefetch" href="/assets/index.html-3cde2e9d.js" as="script"><link rel="prefetch" href="/assets/04-Springä¹‹Beanç”Ÿå‘½å‘¨æœŸæºç è§£æä¸Š.html-e29efed5.js" as="script"><link rel="prefetch" href="/assets/index.html-056a7c7b.js" as="script"><link rel="prefetch" href="/assets/index.html-196aee9a.js" as="script"><link rel="prefetch" href="/assets/index.html-15356fd6.js" as="script"><link rel="prefetch" href="/assets/index.html-b2ea937f.js" as="script"><link rel="prefetch" href="/assets/index.html-fae2cce2.js" as="script"><link rel="prefetch" href="/assets/index.html-3de3ac13.js" as="script"><link rel="prefetch" href="/assets/index.html-4fc833f7.js" as="script"><link rel="prefetch" href="/assets/index.html-a9380d59.js" as="script"><link rel="prefetch" href="/assets/index.html-0c227f79.js" as="script"><link rel="prefetch" href="/assets/index.html-ca9e9edd.js" as="script"><link rel="prefetch" href="/assets/index.html-3d73ef7f.js" as="script"><link rel="prefetch" href="/assets/index.html-eff3b4ec.js" as="script"><link rel="prefetch" href="/assets/index.html-63004bbb.js" as="script"><link rel="prefetch" href="/assets/index.html-b443c91f.js" as="script"><link rel="prefetch" href="/assets/index.html-eb7dc294.js" as="script"><link rel="prefetch" href="/assets/index.html-b3f10bbb.js" as="script"><link rel="prefetch" href="/assets/index.html-6036577c.js" as="script"><link rel="prefetch" href="/assets/index.html-58352f8e.js" as="script"><link rel="prefetch" href="/assets/index.html-47cee948.js" as="script"><link rel="prefetch" href="/assets/index.html-1460385b.js" as="script"><link rel="prefetch" href="/assets/00.ç«™åœ¨å…¨å±€è§†è§’ç†è§£ç³»ç»Ÿé«˜å¹¶å‘.html-3a469a4c.js" as="script"><link rel="prefetch" href="/assets/index.html-1fffc64f.js" as="script"><link rel="prefetch" href="/assets/10.BIO NIOç¼–ç¨‹ä¸ç›´æ¥å†…å­˜é›¶æ‹·è´.html-0ab5e5cc.js" as="script"><link rel="prefetch" href="/assets/index.html-fbcf9615.js" as="script"><link rel="prefetch" href="/assets/index.html-a1cae865.js" as="script"><link rel="prefetch" href="/assets/index.html-e045b02c.js" as="script"><link rel="prefetch" href="/assets/index.html-ab40fe3b.js" as="script"><link rel="prefetch" href="/assets/100.é«˜å¹¶å‘ç¼“å­˜å®æˆ˜.html-58f47ed2.js" as="script"><link rel="prefetch" href="/assets/index.html-78dacd72.js" as="script"><link rel="prefetch" href="/assets/30.å¾®æœåŠ¡æ¶æ„æ‹†åˆ†å®æˆ˜.html-d6647704.js" as="script"><link rel="prefetch" href="/assets/index.html-59afda48.js" as="script"><link rel="prefetch" href="/assets/50.å¾®æœåŠ¡ç½‘å…³æ•´åˆOAuth2.0æˆæƒä¸­å¿ƒ.html-d969e8ed.js" as="script"><link rel="prefetch" href="/assets/index.html-edca6dc4.js" as="script"><link rel="prefetch" href="/assets/index.html-1ae26749.js" as="script"><link rel="prefetch" href="/assets/index.html-f93219f2.js" as="script"><link rel="prefetch" href="/assets/index.html-31118532.js" as="script"><link rel="prefetch" href="/assets/å·¥å‚æ¨¡å¼.html-ad9410a3.js" as="script"><link rel="prefetch" href="/assets/å»ºé€ æ¨¡å¼.html-a04d73b9.js" as="script"><link rel="prefetch" href="/assets/index.html-c071222c.js" as="script"><link rel="prefetch" href="/assets/index.html-a4f315bf.js" as="script"><link rel="prefetch" href="/assets/index.html-b0022173.js" as="script"><link rel="prefetch" href="/assets/index.html-38e14dc8.js" as="script"><link rel="prefetch" href="/assets/index.html-cc3cc56c.js" as="script"><link rel="prefetch" href="/assets/index.html-68bfa6a5.js" as="script"><link rel="prefetch" href="/assets/00.é«˜æ€§èƒ½MySQL-MySQLæ¶æ„.html-6d7f7e17.js" as="script"><link rel="prefetch" href="/assets/index.html-4cecd512.js" as="script"><link rel="prefetch" href="/assets/index.html-99ad6842.js" as="script"><link rel="prefetch" href="/assets/index.html-675c676e.js" as="script"><link rel="prefetch" href="/assets/index.html-2855e279.js" as="script"><link rel="prefetch" href="/assets/index.html-9c62895c.js" as="script"><link rel="prefetch" href="/assets/index.html-aa30bf04.js" as="script"><link rel="prefetch" href="/assets/index.html-18f91996.js" as="script"><link rel="prefetch" href="/assets/index.html-d4863e55.js" as="script"><link rel="prefetch" href="/assets/index.html-546eb3a2.js" as="script"><link rel="prefetch" href="/assets/06.MySQLäº‹åŠ¡åŸç†ä¸ä¼˜åŒ–æœ€ä½³å®è·µ.html-0e42a487.js" as="script"><link rel="prefetch" href="/assets/index.html-53d3a5ee.js" as="script"><link rel="prefetch" href="/assets/index.html-2ee74260.js" as="script"><link rel="prefetch" href="/assets/index.html-1f029277.js" as="script"><link rel="prefetch" href="/assets/index.html-c20a9e23.js" as="script"><link rel="prefetch" href="/assets/index.html-af52d031.js" as="script"><link rel="prefetch" href="/assets/index.html-9308d7ca.js" as="script"><link rel="prefetch" href="/assets/20.å…³ç³»å‹æ•°æ®åº“å±‚é¢çš„é«˜å¹¶å‘ä¼˜åŒ–.html-610c7929.js" as="script"><link rel="prefetch" href="/assets/Sharding-JDBCåˆ†åº“åˆ†è¡¨åº”ç”¨å®æˆ˜.html-fe196458.js" as="script"><link rel="prefetch" href="/assets/index.html-d1e1f170.js" as="script"><link rel="prefetch" href="/assets/10.ShardingJDBCåˆ†åº“åˆ†è¡¨å®æˆ˜æŒ‡å—.html-fbff4896.js" as="script"><link rel="prefetch" href="/assets/20.ShardingJDBCæºç ä¸å†…æ ¸è§£æ.html-1d5254a6.js" as="script"><link rel="prefetch" href="/assets/index.html-263f14aa.js" as="script"><link rel="prefetch" href="/assets/index.html-768ded15.js" as="script"><link rel="prefetch" href="/assets/index.html-25fcc8f6.js" as="script"><link rel="prefetch" href="/assets/index.html-8e0ddc23.js" as="script"><link rel="prefetch" href="/assets/index.html-ad1ece24.js" as="script"><link rel="prefetch" href="/assets/index.html-fb73493c.js" as="script"><link rel="prefetch" href="/assets/index.html-128d4b71.js" as="script"><link rel="prefetch" href="/assets/index.html-d9f15724.js" as="script"><link rel="prefetch" href="/assets/index.html-72ba2d35.js" as="script"><link rel="prefetch" href="/assets/index.html-951dfe3f.js" as="script"><link rel="prefetch" href="/assets/index.html-c6d45626.js" as="script"><link rel="prefetch" href="/assets/index.html-859c676b.js" as="script"><link rel="prefetch" href="/assets/index.html-fe205ef8.js" as="script"><link rel="prefetch" href="/assets/index.html-0cb20f1c.js" as="script"><link rel="prefetch" href="/assets/index.html-102cfae4.js" as="script"><link rel="prefetch" href="/assets/index.html-ae48c1df.js" as="script"><link rel="prefetch" href="/assets/index.html-814f7f1d.js" as="script"><link rel="prefetch" href="/assets/index.html-19779ea0.js" as="script"><link rel="prefetch" href="/assets/index.html-09cc3a43.js" as="script"><link rel="prefetch" href="/assets/index.html-cccbb13c.js" as="script"><link rel="prefetch" href="/assets/index.html-b8130103.js" as="script"><link rel="prefetch" href="/assets/index.html-1b4e8107.js" as="script"><link rel="prefetch" href="/assets/index.html-7045cf91.js" as="script"><link rel="prefetch" href="/assets/index.html-82e85232.js" as="script"><link rel="prefetch" href="/assets/index.html-46b70d01.js" as="script"><link rel="prefetch" href="/assets/index.html-a6c441fe.js" as="script"><link rel="prefetch" href="/assets/index.html-38736ecd.js" as="script"><link rel="prefetch" href="/assets/index.html-3d160279.js" as="script"><link rel="prefetch" href="/assets/index.html-70184545.js" as="script"><link rel="prefetch" href="/assets/index.html-0d7f9c84.js" as="script"><link rel="prefetch" href="/assets/index.html-50ec0628.js" as="script"><link rel="prefetch" href="/assets/index.html-6647c88b.js" as="script"><link rel="prefetch" href="/assets/index.html-e5fca210.js" as="script"><link rel="prefetch" href="/assets/index.html-4622c4d0.js" as="script"><link rel="prefetch" href="/assets/index.html-0aa16773.js" as="script"><link rel="prefetch" href="/assets/index.html-bcad5cb1.js" as="script"><link rel="prefetch" href="/assets/index.html-63434f2e.js" as="script"><link rel="prefetch" href="/assets/index.html-645f2ddf.js" as="script"><link rel="prefetch" href="/assets/index.html-254985ce.js" as="script"><link rel="prefetch" href="/assets/index.html-a8a57423.js" as="script"><link rel="prefetch" href="/assets/index.html-60388c3a.js" as="script"><link rel="prefetch" href="/assets/index.html-159ca966.js" as="script"><link rel="prefetch" href="/assets/index.html-f0d68cb4.js" as="script"><link rel="prefetch" href="/assets/index.html-fbc23d80.js" as="script"><link rel="prefetch" href="/assets/index.html-d478e84e.js" as="script"><link rel="prefetch" href="/assets/index.html-2c89d1e5.js" as="script"><link rel="prefetch" href="/assets/index.html-22f6ba4c.js" as="script"><link rel="prefetch" href="/assets/index.html-8d73c7f5.js" as="script"><link rel="prefetch" href="/assets/index.html-1534c5b2.js" as="script"><link rel="prefetch" href="/assets/index.html-7c9f70b1.js" as="script"><link rel="prefetch" href="/assets/index.html-e60f4990.js" as="script"><link rel="prefetch" href="/assets/index.html-775dacd4.js" as="script"><link rel="prefetch" href="/assets/index.html-cd6512b5.js" as="script"><link rel="prefetch" href="/assets/index.html-0df55126.js" as="script"><link rel="prefetch" href="/assets/index.html-ee2ee741.js" as="script"><link rel="prefetch" href="/assets/index.html-0cefaac0.js" as="script"><link rel="prefetch" href="/assets/Seataäº‹åŠ¡æ¨¡å¼.html-c1a2d7b8.js" as="script"><link rel="prefetch" href="/assets/åˆ†å¸ƒå¼äº‹åŠ¡ç»„ä»¶Seata.html-1dd75d49.js" as="script"><link rel="prefetch" href="/assets/index.html-e6f50774.js" as="script"><link rel="prefetch" href="/assets/index.html-881fba3f.js" as="script"><link rel="prefetch" href="/assets/02.RocketMQå¼€å‘æ¨¡å‹ä¸ç”Ÿäº§ç¯å¢ƒé—®é¢˜å‰–æ.html-eb0655fe.js" as="script"><link rel="prefetch" href="/assets/404.html-f4f9fdbe.js" as="script"><link rel="prefetch" href="/assets/index.html-ccedd87a.js" as="script"><link rel="prefetch" href="/assets/index.html-6b635626.js" as="script"><link rel="prefetch" href="/assets/index.html-0d639806.js" as="script"><link rel="prefetch" href="/assets/index.html-19b5aac4.js" as="script"><link rel="prefetch" href="/assets/index.html-f3c1ea90.js" as="script"><link rel="prefetch" href="/assets/index.html-e4505c26.js" as="script"><link rel="prefetch" href="/assets/index.html-c67c6358.js" as="script"><link rel="prefetch" href="/assets/index.html-08bdbe35.js" as="script"><link rel="prefetch" href="/assets/index.html-39a19522.js" as="script"><link rel="prefetch" href="/assets/index.html-4e6ecfce.js" as="script"><link rel="prefetch" href="/assets/index.html-c37db087.js" as="script"><link rel="prefetch" href="/assets/index.html-7f2f880b.js" as="script"><link rel="prefetch" href="/assets/index.html-f8546af5.js" as="script"><link rel="prefetch" href="/assets/index.html-36e6cb8c.js" as="script"><link rel="prefetch" href="/assets/index.html-27371869.js" as="script"><link rel="prefetch" href="/assets/index.html-4c15c6fc.js" as="script"><link rel="prefetch" href="/assets/index.html-116aca17.js" as="script"><link rel="prefetch" href="/assets/index.html-2a643c60.js" as="script"><link rel="prefetch" href="/assets/index.html-21236a9b.js" as="script"><link rel="prefetch" href="/assets/index.html-b238d9f4.js" as="script"><link rel="prefetch" href="/assets/index.html-46e55ee3.js" as="script"><link rel="prefetch" href="/assets/index.html-6d53c5d1.js" as="script"><link rel="prefetch" href="/assets/index.html-778d883e.js" as="script"><link rel="prefetch" href="/assets/index.html-d798a209.js" as="script"><link rel="prefetch" href="/assets/index.html-9fa57983.js" as="script"><link rel="prefetch" href="/assets/index.html-ab8b6fb7.js" as="script"><link rel="prefetch" href="/assets/index.html-200c9b62.js" as="script"><link rel="prefetch" href="/assets/index.html-d67216d5.js" as="script"><link rel="prefetch" href="/assets/index.html-30ef2e2b.js" as="script"><link rel="prefetch" href="/assets/index.html-2a6dfb95.js" as="script"><link rel="prefetch" href="/assets/index.html-3fd779a7.js" as="script"><link rel="prefetch" href="/assets/index.html-0118c6d9.js" as="script"><link rel="prefetch" href="/assets/index.html-41b511cf.js" as="script"><link rel="prefetch" href="/assets/index.html-942ff972.js" as="script"><link rel="prefetch" href="/assets/index.html-2be3f4a2.js" as="script"><link rel="prefetch" href="/assets/index.html-4b04c8af.js" as="script"><link rel="prefetch" href="/assets/index.html-f3f33451.js" as="script"><link rel="prefetch" href="/assets/index.html-940c35a3.js" as="script"><link rel="prefetch" href="/assets/index.html-1a8f23e9.js" as="script"><link rel="prefetch" href="/assets/index.html-c93e5cd2.js" as="script"><link rel="prefetch" href="/assets/index.html-6508b456.js" as="script"><link rel="prefetch" href="/assets/index.html-d92890df.js" as="script"><link rel="prefetch" href="/assets/index.html-b2b41008.js" as="script"><link rel="prefetch" href="/assets/index.html-ed0506a1.js" as="script"><link rel="prefetch" href="/assets/index.html-ac4c44c1.js" as="script"><link rel="prefetch" href="/assets/index.html-0ef231d8.js" as="script"><link rel="prefetch" href="/assets/intro.html-1534cff9.js" as="script"><link rel="prefetch" href="/assets/index.html-b9ef54d3.js" as="script"><link rel="prefetch" href="/assets/slides.html-c1f13126.js" as="script"><link rel="prefetch" href="/assets/index.html-c41c17ee.js" as="script"><link rel="prefetch" href="/assets/index.html-33a28639.js" as="script"><link rel="prefetch" href="/assets/index.html-99549339.js" as="script"><link rel="prefetch" href="/assets/04-Springä¹‹Beanç”Ÿå‘½å‘¨æœŸæºç è§£æä¸Š.html-ef0edff8.js" as="script"><link rel="prefetch" href="/assets/index.html-9bb02a02.js" as="script"><link rel="prefetch" href="/assets/index.html-593591fd.js" as="script"><link rel="prefetch" href="/assets/index.html-bc476d77.js" as="script"><link rel="prefetch" href="/assets/index.html-0411d0ed.js" as="script"><link rel="prefetch" href="/assets/index.html-5c950c27.js" as="script"><link rel="prefetch" href="/assets/index.html-fd5fb029.js" as="script"><link rel="prefetch" href="/assets/index.html-19bcbe86.js" as="script"><link rel="prefetch" href="/assets/index.html-11858a28.js" as="script"><link rel="prefetch" href="/assets/index.html-123e5ffb.js" as="script"><link rel="prefetch" href="/assets/index.html-c04a70de.js" as="script"><link rel="prefetch" href="/assets/index.html-3cb86069.js" as="script"><link rel="prefetch" href="/assets/index.html-7cead407.js" as="script"><link rel="prefetch" href="/assets/index.html-f35dbb09.js" as="script"><link rel="prefetch" href="/assets/index.html-b2e85ea0.js" as="script"><link rel="prefetch" href="/assets/index.html-f849173e.js" as="script"><link rel="prefetch" href="/assets/index.html-789c7f96.js" as="script"><link rel="prefetch" href="/assets/index.html-4fffbeeb.js" as="script"><link rel="prefetch" href="/assets/index.html-859e3097.js" as="script"><link rel="prefetch" href="/assets/index.html-4d3422c7.js" as="script"><link rel="prefetch" href="/assets/index.html-0292b67e.js" as="script"><link rel="prefetch" href="/assets/00.ç«™åœ¨å…¨å±€è§†è§’ç†è§£ç³»ç»Ÿé«˜å¹¶å‘.html-518d6a0e.js" as="script"><link rel="prefetch" href="/assets/index.html-97a62811.js" as="script"><link rel="prefetch" href="/assets/10.BIO NIOç¼–ç¨‹ä¸ç›´æ¥å†…å­˜é›¶æ‹·è´.html-df29a1a2.js" as="script"><link rel="prefetch" href="/assets/index.html-8c267f92.js" as="script"><link rel="prefetch" href="/assets/index.html-6c51f37f.js" as="script"><link rel="prefetch" href="/assets/index.html-1b69acc6.js" as="script"><link rel="prefetch" href="/assets/index.html-b5ab3d0a.js" as="script"><link rel="prefetch" href="/assets/100.é«˜å¹¶å‘ç¼“å­˜å®æˆ˜.html-04480c7b.js" as="script"><link rel="prefetch" href="/assets/index.html-5f798258.js" as="script"><link rel="prefetch" href="/assets/30.å¾®æœåŠ¡æ¶æ„æ‹†åˆ†å®æˆ˜.html-ff8d33ef.js" as="script"><link rel="prefetch" href="/assets/index.html-5f36b633.js" as="script"><link rel="prefetch" href="/assets/50.å¾®æœåŠ¡ç½‘å…³æ•´åˆOAuth2.0æˆæƒä¸­å¿ƒ.html-4cbc5e0a.js" as="script"><link rel="prefetch" href="/assets/index.html-79a9dcad.js" as="script"><link rel="prefetch" href="/assets/index.html-888d5791.js" as="script"><link rel="prefetch" href="/assets/index.html-45485371.js" as="script"><link rel="prefetch" href="/assets/index.html-fe8b12e5.js" as="script"><link rel="prefetch" href="/assets/å·¥å‚æ¨¡å¼.html-5d00ddae.js" as="script"><link rel="prefetch" href="/assets/å»ºé€ æ¨¡å¼.html-2f896000.js" as="script"><link rel="prefetch" href="/assets/index.html-f4cf0d43.js" as="script"><link rel="prefetch" href="/assets/index.html-bdcaed66.js" as="script"><link rel="prefetch" href="/assets/index.html-5e8162db.js" as="script"><link rel="prefetch" href="/assets/index.html-1053a2cd.js" as="script"><link rel="prefetch" href="/assets/index.html-b5c55f02.js" as="script"><link rel="prefetch" href="/assets/index.html-43dca84a.js" as="script"><link rel="prefetch" href="/assets/00.é«˜æ€§èƒ½MySQL-MySQLæ¶æ„.html-29da47a5.js" as="script"><link rel="prefetch" href="/assets/index.html-85748a34.js" as="script"><link rel="prefetch" href="/assets/index.html-82f9645c.js" as="script"><link rel="prefetch" href="/assets/index.html-5d93c981.js" as="script"><link rel="prefetch" href="/assets/index.html-b0527e36.js" as="script"><link rel="prefetch" href="/assets/index.html-f2247e3b.js" as="script"><link rel="prefetch" href="/assets/index.html-248a2ffe.js" as="script"><link rel="prefetch" href="/assets/index.html-b2b987f8.js" as="script"><link rel="prefetch" href="/assets/index.html-83d8990c.js" as="script"><link rel="prefetch" href="/assets/index.html-241661b4.js" as="script"><link rel="prefetch" href="/assets/06.MySQLäº‹åŠ¡åŸç†ä¸ä¼˜åŒ–æœ€ä½³å®è·µ.html-4175bb43.js" as="script"><link rel="prefetch" href="/assets/index.html-807bf4b3.js" as="script"><link rel="prefetch" href="/assets/index.html-dd33c233.js" as="script"><link rel="prefetch" href="/assets/index.html-4232d92b.js" as="script"><link rel="prefetch" href="/assets/index.html-3967073d.js" as="script"><link rel="prefetch" href="/assets/index.html-92dd5d75.js" as="script"><link rel="prefetch" href="/assets/index.html-0f01692d.js" as="script"><link rel="prefetch" href="/assets/20.å…³ç³»å‹æ•°æ®åº“å±‚é¢çš„é«˜å¹¶å‘ä¼˜åŒ–.html-b1767083.js" as="script"><link rel="prefetch" href="/assets/Sharding-JDBCåˆ†åº“åˆ†è¡¨åº”ç”¨å®æˆ˜.html-c0c4ed01.js" as="script"><link rel="prefetch" href="/assets/index.html-e2f05784.js" as="script"><link rel="prefetch" href="/assets/10.ShardingJDBCåˆ†åº“åˆ†è¡¨å®æˆ˜æŒ‡å—.html-d40c40d5.js" as="script"><link rel="prefetch" href="/assets/20.ShardingJDBCæºç ä¸å†…æ ¸è§£æ.html-4c6f716b.js" as="script"><link rel="prefetch" href="/assets/index.html-519339f5.js" as="script"><link rel="prefetch" href="/assets/index.html-c18428dd.js" as="script"><link rel="prefetch" href="/assets/index.html-07f44b51.js" as="script"><link rel="prefetch" href="/assets/index.html-a624eba4.js" as="script"><link rel="prefetch" href="/assets/index.html-c48fb7bf.js" as="script"><link rel="prefetch" href="/assets/index.html-90d7e407.js" as="script"><link rel="prefetch" href="/assets/index.html-06581ff6.js" as="script"><link rel="prefetch" href="/assets/index.html-ae50071f.js" as="script"><link rel="prefetch" href="/assets/index.html-7fd2c1d7.js" as="script"><link rel="prefetch" href="/assets/index.html-a3aa9d52.js" as="script"><link rel="prefetch" href="/assets/index.html-5be4934b.js" as="script"><link rel="prefetch" href="/assets/index.html-39cba0c1.js" as="script"><link rel="prefetch" href="/assets/index.html-3288f0b7.js" as="script"><link rel="prefetch" href="/assets/index.html-8780dd0c.js" as="script"><link rel="prefetch" href="/assets/index.html-a467bfa9.js" as="script"><link rel="prefetch" href="/assets/index.html-2c6c5ea2.js" as="script"><link rel="prefetch" href="/assets/index.html-07a1b646.js" as="script"><link rel="prefetch" href="/assets/index.html-d75eed32.js" as="script"><link rel="prefetch" href="/assets/index.html-433879d8.js" as="script"><link rel="prefetch" href="/assets/index.html-880aa5b3.js" as="script"><link rel="prefetch" href="/assets/index.html-e876545f.js" as="script"><link rel="prefetch" href="/assets/index.html-c5151dd6.js" as="script"><link rel="prefetch" href="/assets/index.html-ad73073a.js" as="script"><link rel="prefetch" href="/assets/index.html-ecb456de.js" as="script"><link rel="prefetch" href="/assets/index.html-041a51c1.js" as="script"><link rel="prefetch" href="/assets/index.html-228f661f.js" as="script"><link rel="prefetch" href="/assets/index.html-4c6c0b82.js" as="script"><link rel="prefetch" href="/assets/index.html-cf92b798.js" as="script"><link rel="prefetch" href="/assets/index.html-63a5728b.js" as="script"><link rel="prefetch" href="/assets/index.html-d8f8d18f.js" as="script"><link rel="prefetch" href="/assets/index.html-ee028baf.js" as="script"><link rel="prefetch" href="/assets/index.html-67d7e0d7.js" as="script"><link rel="prefetch" href="/assets/index.html-4542f54b.js" as="script"><link rel="prefetch" href="/assets/index.html-e45b0d7c.js" as="script"><link rel="prefetch" href="/assets/index.html-8a3c7439.js" as="script"><link rel="prefetch" href="/assets/index.html-9100611e.js" as="script"><link rel="prefetch" href="/assets/index.html-982db96e.js" as="script"><link rel="prefetch" href="/assets/index.html-75db7947.js" as="script"><link rel="prefetch" href="/assets/index.html-935e2e4c.js" as="script"><link rel="prefetch" href="/assets/index.html-c1486706.js" as="script"><link rel="prefetch" href="/assets/index.html-f4d421e4.js" as="script"><link rel="prefetch" href="/assets/index.html-741750a6.js" as="script"><link rel="prefetch" href="/assets/index.html-459a901f.js" as="script"><link rel="prefetch" href="/assets/index.html-74a206d2.js" as="script"><link rel="prefetch" href="/assets/index.html-1edcf98d.js" as="script"><link rel="prefetch" href="/assets/index.html-860d465c.js" as="script"><link rel="prefetch" href="/assets/index.html-4c9840cd.js" as="script"><link rel="prefetch" href="/assets/index.html-009cbb5a.js" as="script"><link rel="prefetch" href="/assets/index.html-6a627085.js" as="script"><link rel="prefetch" href="/assets/index.html-0001981f.js" as="script"><link rel="prefetch" href="/assets/index.html-8e9ccb9d.js" as="script"><link rel="prefetch" href="/assets/index.html-e3af014b.js" as="script"><link rel="prefetch" href="/assets/index.html-991e95c6.js" as="script"><link rel="prefetch" href="/assets/index.html-a60497e1.js" as="script"><link rel="prefetch" href="/assets/index.html-c93dbbf6.js" as="script"><link rel="prefetch" href="/assets/index.html-85335f63.js" as="script"><link rel="prefetch" href="/assets/Seataäº‹åŠ¡æ¨¡å¼.html-e750a9ca.js" as="script"><link rel="prefetch" href="/assets/åˆ†å¸ƒå¼äº‹åŠ¡ç»„ä»¶Seata.html-10f3d852.js" as="script"><link rel="prefetch" href="/assets/index.html-af28632d.js" as="script"><link rel="prefetch" href="/assets/index.html-3042fd82.js" as="script"><link rel="prefetch" href="/assets/02.RocketMQå¼€å‘æ¨¡å‹ä¸ç”Ÿäº§ç¯å¢ƒé—®é¢˜å‰–æ.html-9bda0661.js" as="script"><link rel="prefetch" href="/assets/404.html-f74ec574.js" as="script"><link rel="prefetch" href="/assets/index.html-c5e3297b.js" as="script"><link rel="prefetch" href="/assets/index.html-24493dad.js" as="script"><link rel="prefetch" href="/assets/index.html-d8325fa4.js" as="script"><link rel="prefetch" href="/assets/index.html-d016ee37.js" as="script"><link rel="prefetch" href="/assets/index.html-767cfa58.js" as="script"><link rel="prefetch" href="/assets/index.html-936e543d.js" as="script"><link rel="prefetch" href="/assets/index.html-239174d3.js" as="script"><link rel="prefetch" href="/assets/index.html-67b87889.js" as="script"><link rel="prefetch" href="/assets/index.html-8a406f75.js" as="script"><link rel="prefetch" href="/assets/index.html-f4b35969.js" as="script"><link rel="prefetch" href="/assets/index.html-51708553.js" as="script"><link rel="prefetch" href="/assets/index.html-570ecc73.js" as="script"><link rel="prefetch" href="/assets/index.html-9d65b19a.js" as="script"><link rel="prefetch" href="/assets/index.html-3e573cf2.js" as="script"><link rel="prefetch" href="/assets/index.html-bdc5ba4b.js" as="script"><link rel="prefetch" href="/assets/index.html-49d045e2.js" as="script"><link rel="prefetch" href="/assets/index.html-ccb8fb88.js" as="script"><link rel="prefetch" href="/assets/index.html-fa60eb51.js" as="script"><link rel="prefetch" href="/assets/index.html-ffbf75c6.js" as="script"><link rel="prefetch" href="/assets/index.html-35dbd033.js" as="script"><link rel="prefetch" href="/assets/index.html-74ed93fa.js" as="script"><link rel="prefetch" href="/assets/index.html-8a9616f5.js" as="script"><link rel="prefetch" href="/assets/index.html-6f88a53e.js" as="script"><link rel="prefetch" href="/assets/index.html-7d3a4c18.js" as="script"><link rel="prefetch" href="/assets/index.html-1732a879.js" as="script"><link rel="prefetch" href="/assets/index.html-a48cdcb6.js" as="script"><link rel="prefetch" href="/assets/index.html-4b7dec97.js" as="script"><link rel="prefetch" href="/assets/index.html-5be637ac.js" as="script"><link rel="prefetch" href="/assets/index.html-eb906ebe.js" as="script"><link rel="prefetch" href="/assets/index.html-7276c6c9.js" as="script"><link rel="prefetch" href="/assets/index.html-edd3dae5.js" as="script"><link rel="prefetch" href="/assets/index.html-a90d842b.js" as="script"><link rel="prefetch" href="/assets/index.html-c658b86f.js" as="script"><link rel="prefetch" href="/assets/index.html-154ecd8f.js" as="script"><link rel="prefetch" href="/assets/index.html-a8f7d25f.js" as="script"><link rel="prefetch" href="/assets/index.html-2451b953.js" as="script"><link rel="prefetch" href="/assets/index.html-c4ed2fb0.js" as="script"><link rel="prefetch" href="/assets/index.html-3716febc.js" as="script"><link rel="prefetch" href="/assets/index.html-42098412.js" as="script"><link rel="prefetch" href="/assets/index.html-38dbc255.js" as="script"><link rel="prefetch" href="/assets/index.html-00584c59.js" as="script"><link rel="prefetch" href="/assets/index.html-a4aef757.js" as="script"><link rel="prefetch" href="/assets/index.html-b50135f9.js" as="script"><link rel="prefetch" href="/assets/index.html-b470873d.js" as="script"><link rel="prefetch" href="/assets/index.html-4ce33c0c.js" as="script"><link rel="prefetch" href="/assets/index.html-8450ba35.js" as="script"><link rel="prefetch" href="/assets/giscus-52604b1e.js" as="script"><link rel="prefetch" href="/assets/auto-fa8841cf.js" as="script"><link rel="prefetch" href="/assets/index-ae8c1e74.js" as="script"><link rel="prefetch" href="/assets/flowchart-d65a1d8e.js" as="script"><link rel="prefetch" href="/assets/mermaid.core-d0065dda.js" as="script"><link rel="prefetch" href="/assets/highlight.esm-75b11b9d.js" as="script"><link rel="prefetch" href="/assets/markdown.esm-0191f9da.js" as="script"><link rel="prefetch" href="/assets/math.esm-70a288c8.js" as="script"><link rel="prefetch" href="/assets/notes.esm-a106bb2c.js" as="script"><link rel="prefetch" href="/assets/reveal.esm-ec5549c1.js" as="script"><link rel="prefetch" href="/assets/search.esm-7e6792e2.js" as="script"><link rel="prefetch" href="/assets/zoom.esm-b83b91d0.js" as="script"><link rel="prefetch" href="/assets/VuePlayground-aba27bbf.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-2450701e.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container no-sidebar has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button type="button" class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a href="/" class="brand"><img class="logo" src="/logo.svg" alt="å­¦ä¹ ç¬”è®°"><!----><span class="site-name hide-in-pad">å­¦ä¹ ç¬”è®°</span></a><!--]--><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><!--[--><!----><!--]--><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!--[--><!----><!----><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!--[--><!----><!--]--><button type="button" class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->KafkaåŸºæœ¬åŸç†</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">æ±Ÿ</span></span><span property="author" content="æ±Ÿ"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-04-02T22:49:56.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 23 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT23M"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item category8 clickable" role="navigation">æ¶ˆæ¯é˜Ÿåˆ—</span><span class="page-category-item category2 clickable" role="navigation">Kafka</span><!--]--><meta property="articleSection" content="æ¶ˆæ¯é˜Ÿåˆ—,Kafka"></span><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/pages/1b65ca/#kafkaçš„ä½¿ç”¨åœºæ™¯" class="router-link-active router-link-exact-active toc-link level2">Kafkaçš„ä½¿ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/pages/1b65ca/#kafkaåŸºæœ¬æ¦‚å¿µ" class="router-link-active router-link-exact-active toc-link level2">KafkaåŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/pages/1b65ca/#kafkaåŸºæœ¬ä½¿ç”¨" class="router-link-active router-link-exact-active toc-link level2">kafkaåŸºæœ¬ä½¿ç”¨</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/pages/1b65ca/#dockerç‰ˆæœ¬kafkaå®‰è£…" class="router-link-active router-link-exact-active toc-link level3">dockerç‰ˆæœ¬kafkaå®‰è£…</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/pages/1b65ca/#æ™®é€šç‰ˆæœ¬kafkaå®‰è£…" class="router-link-active router-link-exact-active toc-link level3">æ™®é€šç‰ˆæœ¬kafkaå®‰è£…</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/pages/1b65ca/#ä¸»é¢˜topicå’Œæ¶ˆæ¯æ—¥å¿—log" class="router-link-active router-link-exact-active toc-link level2">ä¸»é¢˜Topicå’Œæ¶ˆæ¯æ—¥å¿—Log</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/pages/1b65ca/#kafkaé›†ç¾¤å®æˆ˜" class="router-link-active router-link-exact-active toc-link level2">kafkaé›†ç¾¤å®æˆ˜</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/pages/1b65ca/#é›†ç¾¤æ¶ˆè´¹" class="router-link-active router-link-exact-active toc-link level3">é›†ç¾¤æ¶ˆè´¹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/pages/1b65ca/#æ¶ˆè´¹é¡ºåº" class="router-link-active router-link-exact-active toc-link level3">æ¶ˆè´¹é¡ºåº</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/pages/1b65ca/#javaå®¢æˆ·ç«¯è®¿é—®kafka" class="router-link-active router-link-exact-active toc-link level3">Javaå®¢æˆ·ç«¯è®¿é—®Kafka</a></li><!----><!--]--></ul></li><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><p>Kafkaæ˜¯æœ€åˆç”±Linkedinå…¬å¸å¼€å‘ï¼Œæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ã€æ”¯æŒåˆ†åŒºçš„ï¼ˆpartitionï¼‰ã€å¤šå‰¯æœ¬çš„ï¼ˆreplicaï¼‰ï¼ŒåŸºäºzookeeperåè°ƒçš„åˆ†å¸ƒå¼æ¶ˆæ¯ç³»ç»Ÿï¼Œå®ƒçš„æœ€å¤§çš„ç‰¹æ€§å°±æ˜¯å¯ä»¥å®æ—¶çš„å¤„ç†å¤§é‡æ•°æ®ä»¥æ»¡è¶³å„ç§éœ€æ±‚åœºæ™¯ï¼šæ¯”å¦‚åŸºäºhadoopçš„æ‰¹å¤„ç†ç³»ç»Ÿã€ä½å»¶è¿Ÿçš„å®æ—¶ç³»ç»Ÿã€Storm/Sparkæµå¼å¤„ç†å¼•æ“ï¼Œweb/nginxæ—¥å¿—ã€è®¿é—®æ—¥å¿—ï¼Œæ¶ˆæ¯æœåŠ¡ç­‰ç­‰ï¼Œç”¨scalaè¯­è¨€ç¼–å†™ï¼ŒLinkedinäº2010å¹´è´¡çŒ®ç»™äº†ApacheåŸºé‡‘ä¼šå¹¶æˆä¸ºé¡¶çº§å¼€æº é¡¹ç›®ã€‚</p><h2 id="kafkaçš„ä½¿ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#kafkaçš„ä½¿ç”¨åœºæ™¯" aria-hidden="true">#</a> Kafkaçš„ä½¿ç”¨åœºæ™¯</h2><ul><li>æ—¥å¿—æ”¶é›†ï¼šä¸€ä¸ªå…¬å¸å¯ä»¥ç”¨Kafkaæ”¶é›†å„ç§æœåŠ¡çš„logï¼Œé€šè¿‡kafkaä»¥ç»Ÿä¸€æ¥å£æœåŠ¡çš„æ–¹å¼å¼€æ”¾ç»™å„ç§consumerï¼Œä¾‹å¦‚hadoopã€Hbaseã€Solrç­‰ã€‚</li><li>æ¶ˆæ¯ç³»ç»Ÿï¼šè§£è€¦å’Œç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ã€ç¼“å­˜æ¶ˆæ¯ç­‰ã€‚</li><li>ç”¨æˆ·æ´»åŠ¨è·Ÿè¸ªï¼šKafkaç»å¸¸è¢«ç”¨æ¥è®°å½•webç”¨æˆ·æˆ–è€…appç”¨æˆ·çš„å„ç§æ´»åŠ¨ï¼Œå¦‚æµè§ˆç½‘é¡µã€æœç´¢ã€ç‚¹å‡»ç­‰æ´»åŠ¨ï¼Œè¿™äº›æ´»åŠ¨ä¿¡æ¯è¢«å„ä¸ªæœåŠ¡å™¨å‘å¸ƒåˆ°kafkaçš„topicä¸­ï¼Œç„¶åè®¢é˜…è€…é€šè¿‡è®¢é˜…è¿™äº›topicæ¥åšå®æ—¶çš„ç›‘æ§åˆ†æï¼Œæˆ–è€…è£…è½½åˆ°hadoopã€æ•°æ®ä»“åº“ä¸­åšç¦»çº¿åˆ†æå’ŒæŒ–æ˜ã€‚</li><li>è¿è¥æŒ‡æ ‡ï¼šKafkaä¹Ÿç»å¸¸ç”¨æ¥è®°å½•è¿è¥ç›‘æ§æ•°æ®ã€‚åŒ…æ‹¬æ”¶é›†å„ç§åˆ†å¸ƒå¼åº”ç”¨çš„æ•°æ®ï¼Œç”Ÿäº§å„ç§æ“ä½œçš„é›†ä¸­åé¦ˆï¼Œæ¯”å¦‚æŠ¥è­¦å’ŒæŠ¥å‘Šã€‚</li></ul><p>â€‹ <img src="https://img.jssjqd.cn/202304021802345.png" alt="" loading="lazy"></p><h2 id="kafkaåŸºæœ¬æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#kafkaåŸºæœ¬æ¦‚å¿µ" aria-hidden="true">#</a> KafkaåŸºæœ¬æ¦‚å¿µ</h2><p>kafkaæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„ï¼Œåˆ†åŒºçš„æ¶ˆæ¯(å®˜æ–¹ç§°ä¹‹ä¸ºcommit log)æœåŠ¡ã€‚å®ƒæä¾›ä¸€ä¸ªæ¶ˆæ¯ç³»ç»Ÿåº”è¯¥å…·å¤‡çš„åŠŸèƒ½ï¼Œä½†æ˜¯ç¡®æœ‰ç€ç‹¬ç‰¹çš„è®¾è®¡ã€‚å¯ä»¥è¿™æ ·æ¥è¯´ï¼ŒKafkaå€Ÿé‰´äº†JMSè§„èŒƒçš„æ€æƒ³ï¼Œä½†æ˜¯ç¡®å¹¶<strong>æ²¡æœ‰å®Œå…¨éµå¾ªJMSè§„èŒƒã€‚</strong></p><p>é¦–å…ˆï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹åŸºç¡€çš„æ¶ˆæ¯(Message)ç›¸å…³æœ¯è¯­ï¼š</p><table><thead><tr><th><strong>åç§°</strong></th><th><strong>è§£é‡Š</strong></th></tr></thead><tbody><tr><td>Broker</td><td>æ¶ˆæ¯ä¸­é—´ä»¶å¤„ç†èŠ‚ç‚¹ï¼Œä¸€ä¸ªKafkaèŠ‚ç‚¹å°±æ˜¯ä¸€ä¸ªbrokerï¼Œä¸€ä¸ªæˆ–è€…å¤šä¸ªBrokerå¯ä»¥ç»„æˆä¸€ä¸ªKafkaé›†ç¾¤</td></tr><tr><td>Topic</td><td>Kafkaæ ¹æ®topicå¯¹æ¶ˆæ¯è¿›è¡Œå½’ç±»ï¼Œå‘å¸ƒåˆ°Kafkaé›†ç¾¤çš„æ¯æ¡æ¶ˆæ¯éƒ½éœ€è¦æŒ‡å®šä¸€ä¸ªtopic</td></tr><tr><td>Producer</td><td>æ¶ˆæ¯ç”Ÿäº§è€…ï¼Œå‘Brokerå‘é€æ¶ˆæ¯çš„å®¢æˆ·ç«¯</td></tr><tr><td>Consumer</td><td>æ¶ˆæ¯æ¶ˆè´¹è€…ï¼Œä»Brokerè¯»å–æ¶ˆæ¯çš„å®¢æˆ·ç«¯</td></tr><tr><td>ConsumerGroup</td><td>æ¯ä¸ªConsumerå±äºä¸€ä¸ªç‰¹å®šçš„Consumer Groupï¼Œä¸€æ¡æ¶ˆæ¯å¯ä»¥è¢«å¤šä¸ªä¸åŒçš„Consumer Groupæ¶ˆè´¹ï¼Œä½†æ˜¯ä¸€ä¸ªConsumer Groupä¸­åªèƒ½æœ‰ä¸€ä¸ªConsumerèƒ½å¤Ÿæ¶ˆè´¹è¯¥æ¶ˆæ¯</td></tr><tr><td>Partition</td><td>ç‰©ç†ä¸Šçš„æ¦‚å¿µï¼Œä¸€ä¸ªtopicå¯ä»¥åˆ†ä¸ºå¤šä¸ªpartitionï¼Œæ¯ä¸ªpartitionå†…éƒ¨æ¶ˆæ¯æ˜¯æœ‰åºçš„</td></tr></tbody></table><p>å› æ­¤ï¼Œä»ä¸€ä¸ªè¾ƒé«˜çš„å±‚é¢ä¸Šæ¥çœ‹ï¼Œproduceré€šè¿‡ç½‘ç»œå‘é€æ¶ˆæ¯åˆ°Kafkaé›†ç¾¤ï¼Œç„¶åconsumeræ¥è¿›è¡Œæ¶ˆè´¹ï¼Œå¦‚ä¸‹å›¾ï¼š</p><figure><img src="https://img.jssjqd.cn/202304021808510.png" alt="image-20230402180759274" tabindex="0" loading="lazy"><figcaption>image-20230402180759274</figcaption></figure><p>æœåŠ¡ç«¯(brokers)å’Œå®¢æˆ·ç«¯(producerã€consumer)ä¹‹é—´é€šä¿¡é€šè¿‡<strong>TCPåè®®</strong>æ¥å®Œæˆã€‚</p><h2 id="kafkaåŸºæœ¬ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#kafkaåŸºæœ¬ä½¿ç”¨" aria-hidden="true">#</a> kafkaåŸºæœ¬ä½¿ç”¨</h2><h3 id="dockerç‰ˆæœ¬kafkaå®‰è£…" tabindex="-1"><a class="header-anchor" href="#dockerç‰ˆæœ¬kafkaå®‰è£…" aria-hidden="true">#</a> dockerç‰ˆæœ¬kafkaå®‰è£…</h3><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&#39;3&#39;</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">zookeeper</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> zookeeper<span class="token punctuation">:</span>3.5.8
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> zookeeper_kafka
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 12181<span class="token punctuation">:</span><span class="token number">2181</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /source/data/kafka/zookeeper/data<span class="token punctuation">:</span>/data
      <span class="token punctuation">-</span> /source/data/kafka/zookeeper/datalog<span class="token punctuation">:</span>/datalog
      <span class="token punctuation">-</span> /source/data/kafka/zookeeper/logs<span class="token punctuation">:</span>/logs
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
  <span class="token key atrule">kafka</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> bitnami/kafka<span class="token punctuation">:</span>2.4.1
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> zookeeper
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> kafka
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 19092<span class="token punctuation">:</span><span class="token number">9092</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">KAFKA_BROKER_ID</span><span class="token punctuation">:</span> <span class="token number">1</span>
      <span class="token key atrule">KAFKA_ZOOKEEPER_CONNECT</span><span class="token punctuation">:</span> zookeeper<span class="token punctuation">:</span><span class="token number">2181</span>
      <span class="token key atrule">KAFKA_ADVERTISED_LISTENERS</span><span class="token punctuation">:</span> PLAINTEXT<span class="token punctuation">:</span>//127.0.0.1<span class="token punctuation">:</span><span class="token number">9092</span>
      <span class="token key atrule">KAFKA_LISTENERS</span><span class="token punctuation">:</span> PLAINTEXT<span class="token punctuation">:</span>//0.0.0.0<span class="token punctuation">:</span><span class="token number">9092</span>
      <span class="token key atrule">KAFKA_LOG_RETENTION_HOURS</span><span class="token punctuation">:</span> <span class="token number">24</span>
      <span class="token key atrule">ALLOW_PLAINTEXT_LISTENER</span> <span class="token punctuation">:</span> yes
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> /source/data/kafka/data<span class="token punctuation">:</span>/data/kafka<span class="token punctuation">-</span>data
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> unless<span class="token punctuation">-</span>stopped  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ™®é€šç‰ˆæœ¬kafkaå®‰è£…" tabindex="-1"><a class="header-anchor" href="#æ™®é€šç‰ˆæœ¬kafkaå®‰è£…" aria-hidden="true">#</a> æ™®é€šç‰ˆæœ¬kafkaå®‰è£…</h3><p><strong>å®‰è£…å‰çš„ç¯å¢ƒå‡†å¤‡</strong></p><p>ç”±äºKafkaæ˜¯ç”¨Scalaè¯­è¨€å¼€å‘çš„ï¼Œè¿è¡Œåœ¨JVMä¸Šï¼Œå› æ­¤åœ¨å®‰è£…Kafkaä¹‹å‰éœ€è¦å…ˆå®‰è£…JDKã€‚</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>yum <span class="token function">install</span> java-1.8.0-openjdk* <span class="token parameter variable">-y</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>kafkaä¾èµ–zookeeperï¼Œæ‰€ä»¥éœ€è¦å…ˆå®‰è£…zookeeper</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">wget</span> https://archive.apache.org/dist/zookeeper/zookeeper-3.5.8/apache-zookeeper-3.5.8-bin.tar.gz
<span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> apache-zookeeper-3.5.8-bin.tar.gz
<span class="token builtin class-name">cd</span>  apache-zookeeper-3.5.8-bin
<span class="token function">cp</span> conf/zoo_sample.cfg conf/zoo.cfg

<span class="token comment"># å¯åŠ¨zookeeper</span>
bin/zkServer.sh start
bin/zkCli.sh 
<span class="token function">ls</span> /			<span class="token comment">#æŸ¥çœ‹zkçš„æ ¹ç›®å½•ç›¸å…³èŠ‚ç‚¹           </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ç¬¬ä¸€æ­¥ï¼šä¸‹è½½å®‰è£…åŒ…</strong></p><p>ä¸‹è½½2.4.1 releaseç‰ˆæœ¬ï¼Œå¹¶è§£å‹ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">wget</span> https://archive.apache.org/dist/kafka/2.4.1/kafka_2.11-2.4.1.tgz  <span class="token comment"># 2.11æ˜¯scalaçš„ç‰ˆæœ¬ï¼Œ2.4.1æ˜¯kafkaçš„ç‰ˆæœ¬</span>
<span class="token function">tar</span> <span class="token parameter variable">-xzf</span> kafka_2.11-2.4.1.tgz
<span class="token builtin class-name">cd</span> kafka_2.11-2.4.1          
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ç¬¬äºŒæ­¥ï¼šä¿®æ”¹é…ç½®</strong></p><p>ä¿®æ”¹é…ç½®æ–‡ä»¶config/server.properties:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">#broker.idå±æ€§åœ¨kafkaé›†ç¾¤ä¸­å¿…é¡»è¦æ˜¯å”¯ä¸€</span>
<span class="token assign-left variable">broker.id</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token comment">#kafkaéƒ¨ç½²çš„æœºå™¨ipå’Œæä¾›æœåŠ¡çš„ç«¯å£å·</span>
<span class="token assign-left variable">listeners</span><span class="token operator">=</span>PLAINTEXT://192.168.65.60:9092   
<span class="token comment">#kafkaçš„æ¶ˆæ¯å­˜å‚¨æ–‡ä»¶</span>
<span class="token assign-left variable">log.dir</span><span class="token operator">=</span>/usr/local/data/kafka-logs
<span class="token comment">#kafkaè¿æ¥zookeeperçš„åœ°å€</span>
<span class="token assign-left variable">zookeeper.connect</span><span class="token operator">=</span><span class="token number">192.168</span>.65.60:2181     
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ç¬¬ä¸‰æ­¥ï¼šå¯åŠ¨æœåŠ¡</strong></p><p>ç°åœ¨æ¥å¯åŠ¨kafkaæœåŠ¡ï¼š</p><p>å¯åŠ¨è„šæœ¬è¯­æ³•ï¼š<a href="http://kafka-server-start.sh" target="_blank" rel="noopener noreferrer">kafka-server-start.sh<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> [-daemon] server.properties</p><p>å¯ä»¥çœ‹åˆ°ï¼Œserver.propertiesçš„é…ç½®è·¯å¾„æ˜¯ä¸€ä¸ªå¼ºåˆ¶çš„å‚æ•°ï¼Œ-daemonè¡¨ç¤ºä»¥åå°è¿›ç¨‹è¿è¡Œï¼Œå¦åˆ™sshå®¢æˆ·ç«¯é€€å‡ºåï¼Œå°±ä¼šåœæ­¢æœåŠ¡ã€‚(æ³¨æ„ï¼Œåœ¨å¯åŠ¨kafkaæ—¶ä¼šä½¿ç”¨linuxä¸»æœºåå…³è”çš„ipåœ°å€ï¼Œæ‰€ä»¥éœ€è¦æŠŠä¸»æœºåå’Œlinuxçš„ipæ˜ å°„é…ç½®åˆ°æœ¬åœ°hosté‡Œï¼Œç”¨vim /etc/hosts)</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># å¯åŠ¨kafkaï¼Œè¿è¡Œæ—¥å¿—åœ¨logsç›®å½•çš„server.logæ–‡ä»¶é‡Œ</span>
bin/kafka-server-start.sh <span class="token parameter variable">-daemon</span> config/server.properties   <span class="token comment">#åå°å¯åŠ¨ï¼Œä¸ä¼šæ‰“å°æ—¥å¿—åˆ°æ§åˆ¶å°</span>
æˆ–è€…ç”¨
bin/kafka-server-start.sh config/server.properties <span class="token operator">&amp;</span>

<span class="token comment"># æˆ‘ä»¬è¿›å…¥zookeeperç›®å½•é€šè¿‡zookeeperå®¢æˆ·ç«¯æŸ¥çœ‹ä¸‹zookeeperçš„ç›®å½•æ ‘</span>
bin/zkCli.sh 
<span class="token function">ls</span> /		<span class="token comment">#æŸ¥çœ‹zkçš„æ ¹ç›®å½•kafkaç›¸å…³èŠ‚ç‚¹</span>
<span class="token function">ls</span> /brokers/ids	<span class="token comment">#æŸ¥çœ‹kafkaèŠ‚ç‚¹</span>

<span class="token comment"># åœæ­¢kafka</span>
bin/kafka-server-stop.sh          
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>server.propertiesæ ¸å¿ƒé…ç½®è¯¦è§£ï¼š</strong></p><table><thead><tr><th><strong>Property</strong></th><th><strong>Default</strong></th><th><strong>Description</strong></th></tr></thead><tbody><tr><td><a href="http://broker.id" target="_blank" rel="noopener noreferrer">broker.id<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></td><td>0</td><td>æ¯ä¸ªbrokeréƒ½å¯ä»¥ç”¨ä¸€ä¸ªå”¯ä¸€çš„éè´Ÿæ•´æ•°idè¿›è¡Œæ ‡è¯†ï¼›è¿™ä¸ªidå¯ä»¥ä½œä¸ºbrokerçš„â€œåå­—â€ï¼Œä½ å¯ä»¥é€‰æ‹©ä»»æ„ä½ å–œæ¬¢çš„æ•°å­—ä½œä¸ºidï¼Œåªè¦idæ˜¯å”¯ä¸€çš„å³å¯ã€‚</td></tr><tr><td>log.dirs</td><td>/tmp/kafka-logs</td><td>kafkaå­˜æ”¾æ•°æ®çš„è·¯å¾„ã€‚è¿™ä¸ªè·¯å¾„å¹¶ä¸æ˜¯å”¯ä¸€çš„ï¼Œå¯ä»¥æ˜¯å¤šä¸ªï¼Œè·¯å¾„ä¹‹é—´åªéœ€è¦ä½¿ç”¨é€—å·åˆ†éš”å³å¯ï¼›æ¯å½“åˆ›å»ºæ–°partitionæ—¶ï¼Œéƒ½ä¼šé€‰æ‹©åœ¨åŒ…å«æœ€å°‘partitionsçš„è·¯å¾„ä¸‹è¿›è¡Œã€‚</td></tr><tr><td>listeners</td><td>PLAINTEXT://192.168.65.60:9092</td><td>serveræ¥å—å®¢æˆ·ç«¯è¿æ¥çš„ç«¯å£ï¼Œipé…ç½®kafkaæœ¬æœºipå³å¯</td></tr><tr><td>zookeeper.connect</td><td>localhost:2181</td><td>zooKeeperè¿æ¥å­—ç¬¦ä¸²çš„æ ¼å¼ä¸ºï¼šhostname:portï¼Œæ­¤å¤„hostnameå’Œportåˆ†åˆ«æ˜¯ZooKeeperé›†ç¾¤ä¸­æŸä¸ªèŠ‚ç‚¹çš„hostå’Œportï¼›zookeeperå¦‚æœæ˜¯é›†ç¾¤ï¼Œè¿æ¥æ–¹å¼ä¸º hostname1:port1, hostname2:port2, hostname3:port3</td></tr><tr><td>log.retention.hours</td><td>168</td><td>æ¯ä¸ªæ—¥å¿—æ–‡ä»¶åˆ é™¤ä¹‹å‰ä¿å­˜çš„æ—¶é—´ã€‚é»˜è®¤æ•°æ®ä¿å­˜æ—¶é—´å¯¹æ‰€æœ‰topicéƒ½ä¸€æ ·ã€‚</td></tr><tr><td>num.partitions</td><td>1</td><td>åˆ›å»ºtopicçš„é»˜è®¤åˆ†åŒºæ•°</td></tr><tr><td>default.replication.factor</td><td>1</td><td>è‡ªåŠ¨åˆ›å»ºtopicçš„é»˜è®¤å‰¯æœ¬æ•°é‡ï¼Œå»ºè®®è®¾ç½®ä¸ºå¤§äºç­‰äº2</td></tr><tr><td>min.insync.replicas</td><td>1</td><td>å½“producerè®¾ç½®acksä¸º-1æ—¶ï¼Œmin.insync.replicasæŒ‡å®šreplicasçš„æœ€å°æ•°ç›®ï¼ˆå¿…é¡»ç¡®è®¤æ¯ä¸€ä¸ªrepicaçš„å†™æ•°æ®éƒ½æ˜¯æˆåŠŸçš„ï¼‰ï¼Œå¦‚æœè¿™ä¸ªæ•°ç›®æ²¡æœ‰è¾¾åˆ°ï¼Œproducerå‘é€æ¶ˆæ¯ä¼šäº§ç”Ÿå¼‚å¸¸</td></tr><tr><td>delete.topic.enable</td><td>false</td><td>æ˜¯å¦å…è®¸åˆ é™¤ä¸»é¢˜</td></tr></tbody></table><p><strong>ç¬¬å››æ­¥ï¼šåˆ›å»ºä¸»é¢˜</strong></p><p>ç°åœ¨æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªåå­—ä¸ºâ€œtestâ€çš„Topicï¼Œè¿™ä¸ªtopicåªæœ‰ä¸€ä¸ªpartitionï¼Œå¹¶ä¸”å¤‡ä»½å› å­ä¹Ÿè®¾ç½®ä¸º1ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>bin/kafka-topics.sh <span class="token parameter variable">--create</span> <span class="token parameter variable">--zookeeper</span> <span class="token number">192.168</span>.65.60:2181 --replication-factor <span class="token number">1</span> <span class="token parameter variable">--partitions</span> <span class="token number">1</span> <span class="token parameter variable">--topic</span> <span class="token builtin class-name">test</span>
ç°åœ¨æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥æŸ¥çœ‹kafkaä¸­ç›®å‰å­˜åœ¨çš„topic
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥æŸ¥çœ‹kafkaä¸­ç›®å‰å­˜åœ¨çš„topic</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>bin/kafka-topics.sh <span class="token parameter variable">--list</span> <span class="token parameter variable">--zookeeper</span> <span class="token number">192.168</span>.65.60:2181
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>é™¤äº†æˆ‘ä»¬é€šè¿‡æ‰‹å·¥çš„æ–¹å¼åˆ›å»ºTopicï¼Œå½“producerå‘å¸ƒä¸€ä¸ªæ¶ˆæ¯åˆ°æŸä¸ªæŒ‡å®šçš„Topicï¼Œè¿™ä¸ªTopicå¦‚æœä¸å­˜åœ¨ï¼Œå°±è‡ªåŠ¨åˆ›å»ºã€‚</p><p><strong>åˆ é™¤ä¸»é¢˜</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>bin/kafka-topics.sh <span class="token parameter variable">--delete</span> <span class="token parameter variable">--topic</span> <span class="token builtin class-name">test</span> <span class="token parameter variable">--zookeeper</span> <span class="token number">192.168</span>.65.60:2181
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>ç¬¬äº”æ­¥ï¼šå‘é€æ¶ˆæ¯</strong></p><p>kafkaè‡ªå¸¦äº†ä¸€ä¸ªproducerå‘½ä»¤å®¢æˆ·ç«¯ï¼Œå¯ä»¥ä»æœ¬åœ°æ–‡ä»¶ä¸­è¯»å–å†…å®¹ï¼Œæˆ–è€…æˆ‘ä»¬ä¹Ÿå¯ä»¥ä»¥å‘½ä»¤è¡Œä¸­ç›´æ¥è¾“å…¥å†…å®¹ï¼Œå¹¶å°†è¿™äº›å†…å®¹ä»¥æ¶ˆæ¯çš„å½¢å¼å‘é€åˆ°kafkaé›†ç¾¤ä¸­ã€‚åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸€ä¸ªè¡Œä¼šè¢«å½“åšæˆä¸€ä¸ªç‹¬ç«‹çš„æ¶ˆæ¯ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬è¦è¿è¡Œå‘å¸ƒæ¶ˆæ¯çš„è„šæœ¬ï¼Œç„¶ååœ¨å‘½ä»¤ä¸­è¾“å…¥è¦å‘é€çš„æ¶ˆæ¯çš„å†…å®¹ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>bin/kafka-console-producer.sh --broker-list <span class="token number">192.168</span>.65.60:9092 <span class="token parameter variable">--topic</span> <span class="token builtin class-name">test</span> 
<span class="token operator">&gt;</span>this is a msg
<span class="token operator">&gt;</span>this is a another msg
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ç¬¬å…­æ­¥ï¼šæ¶ˆè´¹æ¶ˆæ¯</strong></p><p>å¯¹äºconsumerï¼ŒkafkaåŒæ ·ä¹Ÿæºå¸¦äº†ä¸€ä¸ªå‘½ä»¤è¡Œå®¢æˆ·ç«¯ï¼Œä¼šå°†è·å–åˆ°å†…å®¹åœ¨å‘½ä»¤ä¸­è¿›è¡Œè¾“å‡ºï¼Œ<strong>é»˜è®¤æ˜¯æ¶ˆè´¹æœ€æ–°çš„æ¶ˆæ¯</strong>ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>bin/kafka-console-consumer.sh --bootstrap-server <span class="token number">192.168</span>.65.60:9092 <span class="token parameter variable">--topic</span> <span class="token builtin class-name">test</span>   
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¦‚æœæƒ³è¦æ¶ˆè´¹ä¹‹å‰çš„æ¶ˆæ¯å¯ä»¥é€šè¿‡--from-beginningå‚æ•°æŒ‡å®šï¼Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>bin/kafka-console-consumer.sh --bootstrap-server <span class="token number">192.168</span>.65.60:9092 --from-beginning <span class="token parameter variable">--topic</span> <span class="token builtin class-name">test</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¦‚æœä½ æ˜¯é€šè¿‡ä¸åŒçš„ç»ˆç«¯çª—å£æ¥è¿è¡Œä»¥ä¸Šçš„å‘½ä»¤ï¼Œä½ å°†ä¼šçœ‹åˆ°åœ¨producerç»ˆç«¯è¾“å…¥çš„å†…å®¹ï¼Œå¾ˆå¿«å°±ä¼šåœ¨consumerçš„ç»ˆç«¯çª—å£ä¸Šæ˜¾ç¤ºå‡ºæ¥ã€‚</p><p>ä»¥ä¸Šæ‰€æœ‰çš„å‘½ä»¤éƒ½æœ‰ä¸€äº›é™„åŠ çš„é€‰é¡¹ï¼›å½“æˆ‘ä»¬ä¸æºå¸¦ä»»ä½•å‚æ•°è¿è¡Œå‘½ä»¤çš„æ—¶å€™ï¼Œå°†ä¼šæ˜¾ç¤ºå‡ºè¿™ä¸ªå‘½ä»¤çš„è¯¦ç»†ç”¨æ³•ã€‚</p><p><strong>æ¶ˆè´¹å¤šä¸»é¢˜</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>bin/kafka-console-consumer.sh --bootstrap-server <span class="token number">192.168</span>.65.60:9092 <span class="token parameter variable">--whitelist</span> <span class="token string">&quot;test|test-2&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>å•æ’­æ¶ˆè´¹</strong></p><p>ä¸€æ¡æ¶ˆæ¯åªèƒ½è¢«æŸä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹çš„æ¨¡å¼ï¼Œç±»ä¼¼queueæ¨¡å¼ï¼Œåªéœ€è®©æ‰€æœ‰æ¶ˆè´¹è€…åœ¨åŒä¸€ä¸ªæ¶ˆè´¹ç»„é‡Œå³å¯</p><p>åˆ†åˆ«åœ¨ä¸¤ä¸ªå®¢æˆ·ç«¯æ‰§è¡Œå¦‚ä¸‹æ¶ˆè´¹å‘½ä»¤ï¼Œç„¶åå¾€ä¸»é¢˜é‡Œå‘é€æ¶ˆæ¯ï¼Œç»“æœåªæœ‰ä¸€ä¸ªå®¢æˆ·ç«¯èƒ½æ”¶åˆ°æ¶ˆæ¯</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>bin/kafka-console-consumer.sh --bootstrap-server <span class="token number">192.168</span>.65.60:9092  --consumer-property <span class="token assign-left variable">group.id</span><span class="token operator">=</span>testGroup <span class="token parameter variable">--topic</span> <span class="token builtin class-name">test</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>å¤šæ’­æ¶ˆè´¹</strong></p><p>ä¸€æ¡æ¶ˆæ¯èƒ½è¢«å¤šä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹çš„æ¨¡å¼ï¼Œç±»ä¼¼publish-subscribeæ¨¡å¼è´¹ï¼Œé’ˆå¯¹KafkaåŒä¸€æ¡æ¶ˆæ¯åªèƒ½è¢«åŒä¸€ä¸ªæ¶ˆè´¹ç»„ä¸‹çš„æŸä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹çš„ç‰¹æ€§ï¼Œè¦å®ç°å¤šæ’­åªè¦ä¿è¯è¿™äº›æ¶ˆè´¹è€…å±äºä¸åŒçš„æ¶ˆè´¹ç»„å³å¯ã€‚æˆ‘ä»¬å†å¢åŠ ä¸€ä¸ªæ¶ˆè´¹è€…ï¼Œè¯¥æ¶ˆè´¹è€…å±äºtestGroup-2æ¶ˆè´¹ç»„ï¼Œç»“æœä¸¤ä¸ªå®¢æˆ·ç«¯éƒ½èƒ½æ”¶åˆ°æ¶ˆæ¯</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>bin/kafka-console-consumer.sh --bootstrap-server <span class="token number">192.168</span>.65.60:9092 --consumer-property <span class="token assign-left variable">group.id</span><span class="token operator">=</span>testGroup-2 <span class="token parameter variable">--topic</span> <span class="token builtin class-name">test</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>æŸ¥çœ‹æ¶ˆè´¹ç»„å</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>bin/kafka-consumer-groups.sh --bootstrap-server <span class="token number">192.168</span>.65.60:9092 <span class="token parameter variable">--list</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>æŸ¥çœ‹æ¶ˆè´¹ç»„çš„æ¶ˆè´¹åç§»é‡</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>bin/kafka-consumer-groups.sh --bootstrap-server <span class="token number">192.168</span>.65.60:9092 <span class="token parameter variable">--describe</span> <span class="token parameter variable">--group</span> testGroup
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://img.jssjqd.cn/202304021900866.png" alt="image-20230402190025421" tabindex="0" loading="lazy"><figcaption>image-20230402190025421</figcaption></figure><p>**current-offsetï¼š**å½“å‰æ¶ˆè´¹ç»„çš„å·²æ¶ˆè´¹åç§»é‡</p><p>**log-end-offsetï¼š**ä¸»é¢˜å¯¹åº”åˆ†åŒºæ¶ˆæ¯çš„ç»“æŸåç§»é‡(HW)</p><p>**lagï¼š**å½“å‰æ¶ˆè´¹ç»„æœªæ¶ˆè´¹çš„æ¶ˆæ¯æ•°</p><h2 id="ä¸»é¢˜topicå’Œæ¶ˆæ¯æ—¥å¿—log" tabindex="-1"><a class="header-anchor" href="#ä¸»é¢˜topicå’Œæ¶ˆæ¯æ—¥å¿—log" aria-hidden="true">#</a> ä¸»é¢˜Topicå’Œæ¶ˆæ¯æ—¥å¿—Log</h2><p>å¯ä»¥ç†è§£Topicæ˜¯ä¸€ä¸ªç±»åˆ«çš„åç§°ï¼ŒåŒç±»æ¶ˆæ¯å‘é€åˆ°åŒä¸€ä¸ªTopicä¸‹é¢ã€‚å¯¹äºæ¯ä¸€ä¸ªTopicï¼Œä¸‹é¢å¯ä»¥æœ‰å¤šä¸ªåˆ†åŒº(Partition)æ—¥å¿—æ–‡ä»¶:</p><figure><img src="https://img.jssjqd.cn/202304021903362.png" alt="image-20230402190341347" tabindex="0" loading="lazy"><figcaption>image-20230402190341347</figcaption></figure><p>Partitionæ˜¯ä¸€ä¸ª<strong>æœ‰åºçš„messageåºåˆ—</strong>ï¼Œè¿™äº›messageæŒ‰é¡ºåºæ·»åŠ åˆ°ä¸€ä¸ªå«åš<strong>commit logçš„æ–‡ä»¶</strong>ä¸­ã€‚æ¯ä¸ªpartitionä¸­çš„æ¶ˆæ¯éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ç¼–å·ï¼Œç§°ä¹‹ä¸ºoffsetï¼Œç”¨æ¥å”¯ä¸€æ ‡ç¤ºæŸä¸ªåˆ†åŒºä¸­çš„messageã€‚</p><p><strong>æ¯ä¸ªpartitionï¼Œéƒ½å¯¹åº”ä¸€ä¸ªcommit logæ–‡ä»¶</strong>ã€‚ä¸€ä¸ªpartitionä¸­çš„messageçš„offsetéƒ½æ˜¯å”¯ä¸€çš„ï¼Œä½†æ˜¯ä¸åŒçš„partitionä¸­çš„messageçš„offsetå¯èƒ½æ˜¯ç›¸åŒçš„ã€‚</p><p>kafkaä¸€èˆ¬ä¸ä¼šåˆ é™¤æ¶ˆæ¯ï¼Œä¸ç®¡è¿™äº›æ¶ˆæ¯æœ‰æ²¡æœ‰è¢«æ¶ˆè´¹ã€‚åªä¼šæ ¹æ®é…ç½®çš„æ—¥å¿—ä¿ç•™æ—¶é—´(log.retention.hours)ç¡®è®¤æ¶ˆæ¯å¤šä¹…è¢«åˆ é™¤ï¼Œé»˜è®¤ä¿ç•™æœ€è¿‘ä¸€å‘¨çš„æ—¥å¿—æ¶ˆæ¯ã€‚kafkaçš„æ€§èƒ½ä¸ä¿ç•™çš„æ¶ˆæ¯æ•°æ®é‡å¤§å°æ²¡æœ‰å…³ç³»ï¼Œå› æ­¤ä¿å­˜å¤§é‡çš„æ•°æ®æ¶ˆæ¯æ—¥å¿—ä¿¡æ¯ä¸ä¼šæœ‰ä»€ä¹ˆå½±å“ã€‚</p><p><strong>æ¯ä¸ªconsumeræ˜¯åŸºäºè‡ªå·±åœ¨commit logä¸­çš„æ¶ˆè´¹è¿›åº¦(offset)æ¥è¿›è¡Œå·¥ä½œçš„</strong>ã€‚åœ¨kafkaä¸­ï¼Œ<strong>æ¶ˆè´¹offsetç”±consumerè‡ªå·±æ¥ç»´æŠ¤</strong>ï¼›ä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬æŒ‰ç…§é¡ºåºé€æ¡æ¶ˆè´¹commit logä¸­çš„æ¶ˆæ¯ï¼Œå½“ç„¶æˆ‘å¯ä»¥é€šè¿‡æŒ‡å®šoffsetæ¥é‡å¤æ¶ˆè´¹æŸäº›æ¶ˆæ¯ï¼Œæˆ–è€…è·³è¿‡æŸäº›æ¶ˆæ¯ã€‚</p><p>è¿™æ„å‘³kafkaä¸­çš„consumerå¯¹é›†ç¾¤çš„å½±å“æ˜¯éå¸¸å°çš„ï¼Œæ·»åŠ ä¸€ä¸ªæˆ–è€…å‡å°‘ä¸€ä¸ªconsumerï¼Œå¯¹äºé›†ç¾¤æˆ–è€…å…¶ä»–consumeræ¥è¯´ï¼Œéƒ½æ˜¯æ²¡æœ‰å½±å“çš„ï¼Œå› ä¸ºæ¯ä¸ªconsumerç»´æŠ¤å„è‡ªçš„æ¶ˆè´¹offsetã€‚</p><p><strong>åˆ›å»ºå¤šä¸ªåˆ†åŒºçš„ä¸»é¢˜ï¼š</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>bin/kafka-topics.sh <span class="token parameter variable">--create</span> <span class="token parameter variable">--zookeeper</span> <span class="token number">192.168</span>.65.60:2181 --replication-factor <span class="token number">1</span> <span class="token parameter variable">--partitions</span> <span class="token number">2</span> <span class="token parameter variable">--topic</span> test1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>æŸ¥çœ‹ä¸‹topicçš„æƒ…å†µ</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code> bin/kafka-topics.sh <span class="token parameter variable">--describe</span> <span class="token parameter variable">--zookeeper</span> <span class="token number">192.168</span>.65.60:2181 <span class="token parameter variable">--topic</span> test1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://img.jssjqd.cn/202304021945620.png" alt="image-20230402194515491" tabindex="0" loading="lazy"><figcaption>image-20230402194515491</figcaption></figure><p>ä»¥ä¸‹æ˜¯è¾“å‡ºå†…å®¹çš„è§£é‡Šï¼Œç¬¬ä¸€è¡Œæ˜¯æ‰€æœ‰åˆ†åŒºçš„æ¦‚è¦ä¿¡æ¯ï¼Œä¹‹åçš„æ¯ä¸€è¡Œè¡¨ç¤ºæ¯ä¸€ä¸ªpartitionçš„ä¿¡æ¯ã€‚</p><ul><li>leaderèŠ‚ç‚¹è´Ÿè´£ç»™å®špartitionçš„æ‰€æœ‰è¯»å†™è¯·æ±‚ã€‚</li><li>replicas è¡¨ç¤ºæŸä¸ªpartitionåœ¨å“ªå‡ ä¸ªbrokerä¸Šå­˜åœ¨å¤‡ä»½ã€‚ä¸ç®¡è¿™ä¸ªå‡ ç‚¹æ˜¯ä¸æ˜¯â€leaderâ€œï¼Œç”šè‡³è¿™ä¸ªèŠ‚ç‚¹æŒ‚äº†ï¼Œä¹Ÿä¼šåˆ—å‡ºã€‚</li><li>isr æ˜¯replicasçš„ä¸€ä¸ªå­é›†ï¼Œå®ƒåªåˆ—å‡ºå½“å‰è¿˜å­˜æ´»ç€çš„ï¼Œå¹¶ä¸”<strong>å·²åŒæ­¥å¤‡ä»½</strong>äº†è¯¥partitionçš„èŠ‚ç‚¹ã€‚</li></ul><p>æˆ‘ä»¬å¯ä»¥è¿è¡Œç›¸åŒçš„å‘½ä»¤æŸ¥çœ‹ä¹‹å‰åˆ›å»ºçš„åç§°ä¸ºâ€testâ€œçš„topic</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>bin/kafka-topics.sh <span class="token parameter variable">--describe</span> <span class="token parameter variable">--zookeeper</span> <span class="token number">192.168</span>.65.60:2181 <span class="token parameter variable">--topic</span> <span class="token builtin class-name">test</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://img.jssjqd.cn/202304021945243.png" alt="image-20230402194534995" tabindex="0" loading="lazy"><figcaption>image-20230402194534995</figcaption></figure><p>ä¹‹å‰è®¾ç½®äº†topicçš„partitionæ•°é‡ä¸º1ï¼Œå¤‡ä»½å› å­ä¸º1ï¼Œå› æ­¤æ˜¾ç¤ºå°±å¦‚ä¸Šæ‰€ç¤ºäº†ã€‚</p><p>å¯ä»¥è¿›å…¥kafkaçš„æ•°æ®æ–‡ä»¶å­˜å‚¨ç›®å½•æŸ¥çœ‹testå’Œtest1ä¸»é¢˜çš„æ¶ˆæ¯æ—¥å¿—æ–‡ä»¶ï¼š</p><figure><img src="https://img.jssjqd.cn/202304021945919.png" alt="image-20230402194546929" tabindex="0" loading="lazy"><figcaption>image-20230402194546929</figcaption></figure><p>æ¶ˆæ¯æ—¥å¿—æ–‡ä»¶ä¸»è¦å­˜æ”¾åœ¨åˆ†åŒºæ–‡ä»¶å¤¹é‡Œçš„ä»¥logç»“å°¾çš„æ—¥å¿—æ–‡ä»¶é‡Œï¼Œå¦‚ä¸‹æ˜¯test1ä¸»é¢˜å¯¹åº”çš„åˆ†åŒº0çš„æ¶ˆæ¯æ—¥å¿—ï¼š</p><figure><img src="https://img.jssjqd.cn/202304021945642.png" alt="image-20230402194553615" tabindex="0" loading="lazy"><figcaption>image-20230402194553615</figcaption></figure><p>å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤<strong>å¢åŠ topicçš„åˆ†åŒºæ•°é‡(ç›®å‰kafkaä¸æ”¯æŒå‡å°‘åˆ†åŒº)</strong>ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>bin/kafka-topics.sh <span class="token parameter variable">-alter</span> <span class="token parameter variable">--partitions</span> <span class="token number">3</span> <span class="token parameter variable">--zookeeper</span> <span class="token number">192.168</span>.65.60:2181 <span class="token parameter variable">--topic</span> <span class="token builtin class-name">test</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>å¯ä»¥è¿™ä¹ˆæ¥ç†è§£Topicï¼ŒPartitionå’ŒBroker</strong></p><p>ä¸€ä¸ªtopicï¼Œä»£è¡¨é€»è¾‘ä¸Šçš„ä¸€ä¸ªä¸šåŠ¡æ•°æ®é›†ï¼Œæ¯”å¦‚æŒ‰æ•°æ®åº“é‡Œä¸åŒè¡¨çš„æ•°æ®æ“ä½œæ¶ˆæ¯åŒºåˆ†æ”¾å…¥ä¸åŒtopicï¼Œè®¢å•ç›¸å…³æ“ä½œæ¶ˆæ¯æ”¾å…¥è®¢å•topicï¼Œç”¨æˆ·ç›¸å…³æ“ä½œæ¶ˆæ¯æ”¾å…¥ç”¨æˆ·topicï¼Œå¯¹äºå¤§å‹ç½‘ç«™æ¥è¯´ï¼Œåç«¯æ•°æ®éƒ½æ˜¯æµ·é‡çš„ï¼Œè®¢å•æ¶ˆæ¯å¾ˆå¯èƒ½æ˜¯éå¸¸å·¨é‡çš„ï¼Œæ¯”å¦‚æœ‰å‡ ç™¾ä¸ªGç”šè‡³è¾¾åˆ°TBçº§åˆ«ï¼Œå¦‚æœæŠŠè¿™ä¹ˆå¤šæ•°æ®éƒ½æ”¾åœ¨ä¸€å°æœºå™¨ä¸Šå¯å®šä¼šæœ‰å®¹é‡é™åˆ¶é—®é¢˜ï¼Œé‚£ä¹ˆå°±å¯ä»¥åœ¨topicå†…éƒ¨åˆ’åˆ†å¤šä¸ªpartitionæ¥åˆ†ç‰‡å­˜å‚¨æ•°æ®ï¼Œä¸åŒçš„partitionå¯ä»¥ä½äºä¸åŒçš„æœºå™¨ä¸Šï¼Œæ¯å°æœºå™¨ä¸Šéƒ½è¿è¡Œä¸€ä¸ªKafkaçš„è¿›ç¨‹Brokerã€‚</p><p><strong>ä¸ºä»€ä¹ˆè¦å¯¹Topicä¸‹æ•°æ®è¿›è¡Œåˆ†åŒºå­˜å‚¨ï¼Ÿ</strong></p><p>1ã€commit logæ–‡ä»¶ä¼šå—åˆ°æ‰€åœ¨æœºå™¨çš„æ–‡ä»¶ç³»ç»Ÿå¤§å°çš„é™åˆ¶ï¼Œåˆ†åŒºä¹‹åå¯ä»¥å°†ä¸åŒçš„åˆ†åŒºæ”¾åœ¨ä¸åŒçš„æœºå™¨ä¸Šï¼Œç›¸å½“äºå¯¹æ•°æ®åšäº†<strong>åˆ†å¸ƒå¼å­˜å‚¨</strong>ï¼Œç†è®ºä¸Šä¸€ä¸ªtopicå¯ä»¥å¤„ç†ä»»æ„æ•°é‡çš„æ•°æ®ã€‚</p><p>2ã€ä¸ºäº†<strong>æé«˜å¹¶è¡Œåº¦</strong>ã€‚</p><h2 id="kafkaé›†ç¾¤å®æˆ˜" tabindex="-1"><a class="header-anchor" href="#kafkaé›†ç¾¤å®æˆ˜" aria-hidden="true">#</a> kafkaé›†ç¾¤å®æˆ˜</h2><p>å¯¹äºkafkaæ¥è¯´ï¼Œä¸€ä¸ªå•ç‹¬çš„brokeræ„å‘³ç€kafkaé›†ç¾¤ä¸­åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ã€‚è¦æƒ³å¢åŠ kafkaé›†ç¾¤ä¸­çš„èŠ‚ç‚¹æ•°é‡ï¼Œåªéœ€è¦å¤šå¯åŠ¨å‡ ä¸ªbrokerå®ä¾‹å³å¯ã€‚ä¸ºäº†æœ‰æ›´å¥½çš„ç†è§£ï¼Œç°åœ¨æˆ‘ä»¬åœ¨ä¸€å°æœºå™¨ä¸ŠåŒæ—¶å¯åŠ¨ä¸‰ä¸ªbrokerå®ä¾‹ã€‚</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å»ºç«‹å¥½å…¶ä»–2ä¸ªbrokerçš„é…ç½®æ–‡ä»¶ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">cp</span> config/server.properties config/server-1.properties
<span class="token function">cp</span> config/server.properties config/server-2.properties
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>é…ç½®æ–‡ä»¶çš„éœ€è¦ä¿®æ”¹çš„å†…å®¹åˆ†åˆ«å¦‚ä¸‹ï¼š</p><p><strong>config/server-1.properties:</strong></p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token comment">#broker.idå±æ€§åœ¨kafkaé›†ç¾¤ä¸­å¿…é¡»è¦æ˜¯å”¯ä¸€</span>
<span class="token key attr-name">broker.id</span><span class="token punctuation">=</span><span class="token value attr-value">1</span>
<span class="token comment">#kafkaéƒ¨ç½²çš„æœºå™¨ipå’Œæä¾›æœåŠ¡çš„ç«¯å£å·</span>
<span class="token key attr-name">listeners</span><span class="token punctuation">=</span><span class="token value attr-value">PLAINTEXT://192.168.65.60:9093   </span>
<span class="token key attr-name">log.dir</span><span class="token punctuation">=</span><span class="token value attr-value">/usr/local/data/kafka-logs-1</span>
<span class="token comment">#kafkaè¿æ¥zookeeperçš„åœ°å€ï¼Œè¦æŠŠå¤šä¸ªkafkaå®ä¾‹ç»„æˆé›†ç¾¤ï¼Œå¯¹åº”è¿æ¥çš„zookeeperå¿…é¡»ç›¸åŒ</span>
<span class="token key attr-name">zookeeper.connect</span><span class="token punctuation">=</span><span class="token value attr-value">192.168.65.60:2181</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>config/server-2.properties:</strong></p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name">broker.id</span><span class="token punctuation">=</span><span class="token value attr-value">2</span>
<span class="token key attr-name">listeners</span><span class="token punctuation">=</span><span class="token value attr-value">PLAINTEXT://192.168.65.60:9094</span>
<span class="token key attr-name">log.dir</span><span class="token punctuation">=</span><span class="token value attr-value">/usr/local/data/kafka-logs-2</span>
<span class="token key attr-name">zookeeper.connect</span><span class="token punctuation">=</span><span class="token value attr-value">192.168.65.60:2181  </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç›®å‰æˆ‘ä»¬å·²ç»æœ‰ä¸€ä¸ªzookeeperå®ä¾‹å’Œä¸€ä¸ªbrokerå®ä¾‹åœ¨è¿è¡Œäº†ï¼Œç°åœ¨æˆ‘ä»¬åªéœ€è¦åœ¨å¯åŠ¨2ä¸ªbrokerå®ä¾‹å³å¯ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>bin/kafka-server-start.sh <span class="token parameter variable">-daemon</span> config/server-1.properties
bin/kafka-server-start.sh <span class="token parameter variable">-daemon</span> config/server-2.properties
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æŸ¥çœ‹zookeeperç¡®è®¤é›†ç¾¤èŠ‚ç‚¹æ˜¯å¦éƒ½æ³¨å†ŒæˆåŠŸï¼š</strong></p><figure><img src="https://img.jssjqd.cn/202304021948485.png" alt="0" tabindex="0" loading="lazy"><figcaption>0</figcaption></figure><p>ç°åœ¨æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„topicï¼Œå‰¯æœ¬æ•°è®¾ç½®ä¸º3ï¼Œåˆ†åŒºæ•°è®¾ç½®ä¸º2ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>bin/kafka-topics.sh <span class="token parameter variable">--create</span> <span class="token parameter variable">--zookeeper</span> <span class="token number">192.168</span>.65.60:2181 --replication-factor <span class="token number">3</span> <span class="token parameter variable">--partitions</span> <span class="token number">2</span> <span class="token parameter variable">--topic</span> my-replicated-topic
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>æŸ¥çœ‹ä¸‹topicçš„æƒ…å†µ</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code> bin/kafka-topics.sh <span class="token parameter variable">--describe</span> <span class="token parameter variable">--zookeeper</span> <span class="token number">192.168</span>.65.60:2181 <span class="token parameter variable">--topic</span> my-replicated-topic
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://img.jssjqd.cn/202304021948519.png" alt="image-20230402194846568" tabindex="0" loading="lazy"><figcaption>image-20230402194846568</figcaption></figure><p>ä»¥ä¸‹æ˜¯è¾“å‡ºå†…å®¹çš„è§£é‡Šï¼Œç¬¬ä¸€è¡Œæ˜¯æ‰€æœ‰åˆ†åŒºçš„æ¦‚è¦ä¿¡æ¯ï¼Œä¹‹åçš„æ¯ä¸€è¡Œè¡¨ç¤ºæ¯ä¸€ä¸ªpartitionçš„ä¿¡æ¯ã€‚</p><ul><li>leaderèŠ‚ç‚¹è´Ÿè´£ç»™å®špartitionçš„æ‰€æœ‰è¯»å†™è¯·æ±‚ï¼ŒåŒä¸€ä¸ªä¸»é¢˜ä¸åŒåˆ†åŒºleaderå‰¯æœ¬ä¸€èˆ¬ä¸ä¸€æ ·(ä¸ºäº†å®¹ç¾)</li><li>replicas è¡¨ç¤ºæŸä¸ªpartitionåœ¨å“ªå‡ ä¸ªbrokerä¸Šå­˜åœ¨å¤‡ä»½ã€‚ä¸ç®¡è¿™ä¸ªå‡ ç‚¹æ˜¯ä¸æ˜¯â€leaderâ€œï¼Œç”šè‡³è¿™ä¸ªèŠ‚ç‚¹æŒ‚äº†ï¼Œä¹Ÿä¼šåˆ—å‡ºã€‚</li><li>isr æ˜¯replicasçš„ä¸€ä¸ªå­é›†ï¼Œå®ƒåªåˆ—å‡ºå½“å‰è¿˜å­˜æ´»ç€çš„ï¼Œå¹¶ä¸”<strong>å·²åŒæ­¥å¤‡ä»½</strong>äº†è¯¥partitionçš„èŠ‚ç‚¹ã€‚</li></ul><p>ç°åœ¨æˆ‘ä»¬å‘æ–°å»ºçš„ my-replicated-topic ä¸­å‘é€ä¸€äº›messageï¼Œkafkaé›†ç¾¤å¯ä»¥åŠ ä¸Šæ‰€æœ‰kafkaèŠ‚ç‚¹ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>bin/kafka-console-producer.sh --broker-list <span class="token number">192.168</span>.65.60:9092,192.168.65.60:9093,192.168.65.60:9094 <span class="token parameter variable">--topic</span> my-replicated-topic
<span class="token operator">&gt;</span>my <span class="token builtin class-name">test</span> msg <span class="token number">1</span>
<span class="token operator">&gt;</span>my <span class="token builtin class-name">test</span> msg <span class="token number">2</span>            
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨å¼€å§‹æ¶ˆè´¹ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>bin/kafka-console-consumer.sh --bootstrap-server <span class="token number">192.168</span>.65.60:9092,192.168.65.60:9093,192.168.65.60:9094 --from-beginning <span class="token parameter variable">--topic</span> my-replicated-topic
my <span class="token builtin class-name">test</span> msg <span class="token number">1</span>
my <span class="token builtin class-name">test</span> msg <span class="token number">2</span>        
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨æˆ‘ä»¬æ¥æµ‹è¯•æˆ‘ä»¬å®¹é”™æ€§ï¼Œå› ä¸ºbroker1ç›®å‰æ˜¯my-replicated-topicçš„åˆ†åŒº0çš„leaderï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å°†å…¶kill</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">ps</span> <span class="token parameter variable">-ef</span> <span class="token operator">|</span> <span class="token function">grep</span> server.properties
<span class="token function">kill</span> <span class="token number">14776</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨å†æ‰§è¡Œå‘½ä»¤ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>bin/kafka-topics.sh <span class="token parameter variable">--describe</span> <span class="token parameter variable">--zookeeper</span> <span class="token number">192.168</span>.65.60:2181 <span class="token parameter variable">--topic</span> my-replicated-topic              
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://img.jssjqd.cn/202304021949832.png" alt="image-20230402194955660" tabindex="0" loading="lazy"><figcaption>image-20230402194955660</figcaption></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåˆ†åŒº0çš„leaderèŠ‚ç‚¹å·²ç»å˜æˆäº†broker 0ã€‚è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨Isrä¸­ï¼Œå·²ç»æ²¡æœ‰äº†1å·èŠ‚ç‚¹ã€‚leaderçš„é€‰ä¸¾ä¹Ÿæ˜¯ä»ISR(in-sync replica)ä¸­è¿›è¡Œçš„ã€‚</p><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬ä¾ç„¶å¯ä»¥ æ¶ˆè´¹æ–°æ¶ˆæ¯ï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>bin/kafka-console-consumer.sh --bootstrap-server <span class="token number">192.168</span>.65.60:9092,192.168.65.60:9093,192.168.65.60:9094 --from-beginning <span class="token parameter variable">--topic</span> my-replicated-topic
my <span class="token builtin class-name">test</span> msg <span class="token number">1</span>
my <span class="token builtin class-name">test</span> msg <span class="token number">2</span>     
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥çœ‹ä¸»é¢˜åˆ†åŒºå¯¹åº”çš„leaderä¿¡æ¯ï¼š</p><figure><img src="https://img.jssjqd.cn/202304021950615.png" alt="image-20230402195036471" tabindex="0" loading="lazy"><figcaption>image-20230402195036471</figcaption></figure><p><strong>kafkaå°†å¾ˆå¤šé›†ç¾¤å…³é”®ä¿¡æ¯è®°å½•åœ¨zookeeperé‡Œï¼Œä¿è¯è‡ªå·±çš„æ— çŠ¶æ€ï¼Œä»è€Œåœ¨æ°´å¹³æ‰©å®¹æ—¶éå¸¸æ–¹ä¾¿ã€‚</strong></p><h3 id="é›†ç¾¤æ¶ˆè´¹" tabindex="-1"><a class="header-anchor" href="#é›†ç¾¤æ¶ˆè´¹" aria-hidden="true">#</a> é›†ç¾¤æ¶ˆè´¹</h3><p>logçš„partitionsåˆ†å¸ƒåœ¨kafkaé›†ç¾¤ä¸­ä¸åŒçš„brokerä¸Šï¼Œæ¯ä¸ªbrokerå¯ä»¥è¯·æ±‚å¤‡ä»½å…¶ä»–brokerä¸Špartitionä¸Šçš„æ•°æ®ã€‚kafkaé›†ç¾¤æ”¯æŒé…ç½®ä¸€ä¸ªpartitionå¤‡ä»½çš„æ•°é‡ã€‚</p><p>é’ˆå¯¹æ¯ä¸ªpartitionï¼Œéƒ½æœ‰ä¸€ä¸ªbrokerèµ·åˆ°â€œleaderâ€çš„ä½œç”¨ï¼Œ0ä¸ªæˆ–å¤šä¸ªå…¶ä»–çš„brokerä½œä¸ºâ€œfollwersâ€çš„ä½œç”¨ã€‚<strong>leaderå¤„ç†æ‰€æœ‰çš„é’ˆå¯¹è¿™ä¸ªpartitionçš„è¯»å†™è¯·æ±‚ï¼Œè€Œfollowersè¢«åŠ¨å¤åˆ¶leaderçš„ç»“æœï¼Œä¸æä¾›è¯»å†™(ä¸»è¦æ˜¯ä¸ºäº†ä¿è¯å¤šå‰¯æœ¬æ•°æ®ä¸æ¶ˆè´¹çš„ä¸€è‡´æ€§)</strong>ã€‚å¦‚æœè¿™ä¸ªleaderå¤±æ•ˆäº†ï¼Œå…¶ä¸­çš„ä¸€ä¸ªfollowerå°†ä¼šè‡ªåŠ¨çš„å˜æˆæ–°çš„leaderã€‚</p><p><strong>Producers</strong></p><p>ç”Ÿäº§è€…å°†æ¶ˆæ¯å‘é€åˆ°topicä¸­å»ï¼ŒåŒæ—¶è´Ÿè´£é€‰æ‹©å°†messageå‘é€åˆ°topicçš„å“ªä¸€ä¸ªpartitionä¸­ã€‚é€šè¿‡round-robinåšç®€å•çš„è´Ÿè½½å‡è¡¡ã€‚ä¹Ÿå¯ä»¥æ ¹æ®æ¶ˆæ¯ä¸­çš„æŸä¸€ä¸ªå…³é”®å­—æ¥è¿›è¡ŒåŒºåˆ†ã€‚é€šå¸¸ç¬¬äºŒç§æ–¹å¼ä½¿ç”¨çš„æ›´å¤šã€‚</p><p><strong>Consumers</strong></p><p>ä¼ ç»Ÿçš„æ¶ˆæ¯ä¼ é€’æ¨¡å¼æœ‰2ç§ï¼šé˜Ÿåˆ—( queue) å’Œï¼ˆpublish-subscribeï¼‰</p><ul><li>queueæ¨¡å¼ï¼šå¤šä¸ªconsumerä»æœåŠ¡å™¨ä¸­è¯»å–æ•°æ®ï¼Œæ¶ˆæ¯åªä¼šåˆ°è¾¾ä¸€ä¸ªconsumerã€‚</li><li>publish-subscribeæ¨¡å¼ï¼šæ¶ˆæ¯ä¼šè¢«å¹¿æ’­ç»™æ‰€æœ‰çš„consumerã€‚</li></ul><p>KafkaåŸºäºè¿™2ç§æ¨¡å¼æä¾›äº†ä¸€ç§consumerçš„æŠ½è±¡æ¦‚å¿µï¼šconsumer groupã€‚</p><ul><li><p>queueæ¨¡å¼ï¼šæ‰€æœ‰çš„consumeréƒ½ä½äºåŒä¸€ä¸ªconsumer group ä¸‹ã€‚</p></li><li><p>publish-subscribeæ¨¡å¼ï¼šæ‰€æœ‰çš„consumeréƒ½æœ‰ç€è‡ªå·±å”¯ä¸€çš„consumer groupã€‚</p><figure><img src="https://img.jssjqd.cn/202304021951883.png" alt="image-20230402195122775" tabindex="0" loading="lazy"><figcaption>image-20230402195122775</figcaption></figure></li></ul><p>ä¸Šå›¾è¯´æ˜ï¼šç”±2ä¸ªbrokerç»„æˆçš„kafkaé›†ç¾¤ï¼ŒæŸä¸ªä¸»é¢˜æ€»å…±æœ‰4ä¸ªpartition(P0-P3)ï¼Œåˆ†åˆ«ä½äºä¸åŒçš„brokerä¸Šã€‚è¿™ä¸ªé›†ç¾¤ç”±2ä¸ªConsumer Groupæ¶ˆè´¹ï¼Œ Aæœ‰2ä¸ªconsumer instances ï¼ŒBæœ‰4ä¸ªã€‚</p><p>é€šå¸¸ä¸€ä¸ªtopicä¼šæœ‰å‡ ä¸ªconsumer groupï¼Œæ¯ä¸ªconsumer groupéƒ½æ˜¯ä¸€ä¸ªé€»è¾‘ä¸Šçš„è®¢é˜…è€…ï¼ˆ logical subscriber ï¼‰ã€‚æ¯ä¸ªconsumer groupç”±å¤šä¸ªconsumer instanceç»„æˆï¼Œä»è€Œè¾¾åˆ°å¯æ‰©å±•å’Œå®¹ç¾çš„åŠŸèƒ½ã€‚</p><h3 id="æ¶ˆè´¹é¡ºåº" tabindex="-1"><a class="header-anchor" href="#æ¶ˆè´¹é¡ºåº" aria-hidden="true">#</a> æ¶ˆè´¹é¡ºåº</h3><p>ä¸€ä¸ªpartitionåŒä¸€ä¸ªæ—¶åˆ»åœ¨ä¸€ä¸ªconsumer groupä¸­åªèƒ½æœ‰ä¸€ä¸ªconsumer instanceåœ¨æ¶ˆè´¹ï¼Œä»è€Œä¿è¯æ¶ˆè´¹é¡ºåºã€‚</p><p><strong>consumer groupä¸­çš„consumer instanceçš„æ•°é‡ä¸èƒ½æ¯”ä¸€ä¸ªTopicä¸­çš„partitionçš„æ•°é‡å¤šï¼Œå¦åˆ™ï¼Œå¤šå‡ºæ¥çš„consumeræ¶ˆè´¹ä¸åˆ°æ¶ˆæ¯ã€‚</strong></p><p>Kafkaåªåœ¨partitionçš„èŒƒå›´å†…ä¿è¯æ¶ˆæ¯æ¶ˆè´¹çš„å±€éƒ¨é¡ºåºæ€§ï¼Œä¸èƒ½åœ¨åŒä¸€ä¸ªtopicä¸­çš„å¤šä¸ªpartitionä¸­ä¿è¯æ€»çš„æ¶ˆè´¹é¡ºåºæ€§ã€‚</p><p>å¦‚æœæœ‰åœ¨æ€»ä½“ä¸Šä¿è¯æ¶ˆè´¹é¡ºåºçš„éœ€æ±‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡å°†topicçš„partitionæ•°é‡è®¾ç½®ä¸º1ï¼Œå°†consumer groupä¸­çš„consumer instanceæ•°é‡ä¹Ÿè®¾ç½®ä¸º1ï¼Œä½†æ˜¯è¿™æ ·ä¼šå½±å“æ€§èƒ½ï¼Œæ‰€ä»¥kafkaçš„é¡ºåºæ¶ˆè´¹å¾ˆå°‘ç”¨ã€‚</p><h3 id="javaå®¢æˆ·ç«¯è®¿é—®kafka" tabindex="-1"><a class="header-anchor" href="#javaå®¢æˆ·ç«¯è®¿é—®kafka" aria-hidden="true">#</a> Javaå®¢æˆ·ç«¯è®¿é—®Kafka</h3><p><strong>å¼•å…¥mavenä¾èµ–</strong></p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.kafka<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>kafka-clients<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.4.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ¶ˆæ¯å‘é€ç«¯ä»£ç </strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tuling<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>kafkaDemo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span><span class="token class-name">JSON</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>producer<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>common<span class="token punctuation">.</span>serialization<span class="token punctuation">.</span></span><span class="token class-name">StringSerializer</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Properties</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">CountDownLatch</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">ExecutionException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">TimeUnit</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MsgProducer</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token constant">TOPIC_NAME</span> <span class="token operator">=</span> <span class="token string">&quot;my-replicated-topic&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span><span class="token punctuation">,</span> <span class="token class-name">ExecutionException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Properties</span> props <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ProducerConfig</span><span class="token punctuation">.</span><span class="token constant">BOOTSTRAP_SERVERS_CONFIG</span><span class="token punctuation">,</span> <span class="token string">&quot;192.168.65.60:9092,192.168.65.60:9093,192.168.65.60:9094&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token comment">/*
         å‘å‡ºæ¶ˆæ¯æŒä¹…åŒ–æœºåˆ¶å‚æ•°
        ï¼ˆ1ï¼‰acks=0ï¼š è¡¨ç¤ºproducerä¸éœ€è¦ç­‰å¾…ä»»ä½•brokerç¡®è®¤æ”¶åˆ°æ¶ˆæ¯çš„å›å¤ï¼Œå°±å¯ä»¥ç»§ç»­å‘é€ä¸‹ä¸€æ¡æ¶ˆæ¯ã€‚æ€§èƒ½æœ€é«˜ï¼Œä½†æ˜¯æœ€å®¹æ˜“ä¸¢æ¶ˆæ¯ã€‚
        ï¼ˆ2ï¼‰acks=1ï¼š è‡³å°‘è¦ç­‰å¾…leaderå·²ç»æˆåŠŸå°†æ•°æ®å†™å…¥æœ¬åœ°logï¼Œä½†æ˜¯ä¸éœ€è¦ç­‰å¾…æ‰€æœ‰followeræ˜¯å¦æˆåŠŸå†™å…¥ã€‚å°±å¯ä»¥ç»§ç»­å‘é€ä¸‹ä¸€
             æ¡æ¶ˆæ¯ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœfolloweræ²¡æœ‰æˆåŠŸå¤‡ä»½æ•°æ®ï¼Œè€Œæ­¤æ—¶leaderåˆæŒ‚æ‰ï¼Œåˆ™æ¶ˆæ¯ä¼šä¸¢å¤±ã€‚
        ï¼ˆ3ï¼‰acks=-1æˆ–allï¼š éœ€è¦ç­‰å¾… min.insync.replicas(é»˜è®¤ä¸º1ï¼Œæ¨èé…ç½®å¤§äºç­‰äº2) è¿™ä¸ªå‚æ•°é…ç½®çš„å‰¯æœ¬ä¸ªæ•°éƒ½æˆåŠŸå†™å…¥æ—¥å¿—ï¼Œè¿™ç§ç­–ç•¥ä¼šä¿è¯
            åªè¦æœ‰ä¸€ä¸ªå¤‡ä»½å­˜æ´»å°±ä¸ä¼šä¸¢å¤±æ•°æ®ã€‚è¿™æ˜¯æœ€å¼ºçš„æ•°æ®ä¿è¯ã€‚ä¸€èˆ¬é™¤éæ˜¯é‡‘èçº§åˆ«ï¼Œæˆ–è·Ÿé’±æ‰“äº¤é“çš„åœºæ™¯æ‰ä¼šä½¿ç”¨è¿™ç§é…ç½®ã€‚
         */</span>
        <span class="token comment">/*props.put(ProducerConfig.ACKS_CONFIG, &quot;1&quot;);
         */</span><span class="token operator">/</span><span class="token operator">*</span>
        å‘é€å¤±è´¥ä¼šé‡è¯•ï¼Œé»˜è®¤é‡è¯•é—´éš”<span class="token number">100</span>msï¼Œé‡è¯•èƒ½ä¿è¯æ¶ˆæ¯å‘é€çš„å¯é æ€§ï¼Œä½†æ˜¯ä¹Ÿå¯èƒ½é€ æˆæ¶ˆæ¯é‡å¤å‘é€ï¼Œæ¯”å¦‚ç½‘ç»œæŠ–åŠ¨ï¼Œæ‰€ä»¥éœ€è¦åœ¨
        æ¥æ”¶è€…é‚£è¾¹åšå¥½æ¶ˆæ¯æ¥æ”¶çš„å¹‚ç­‰æ€§å¤„ç†
        <span class="token operator">*</span><span class="token comment">//*</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ProducerConfig</span><span class="token punctuation">.</span><span class="token constant">RETRIES_CONFIG</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//é‡è¯•é—´éš”è®¾ç½®</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ProducerConfig</span><span class="token punctuation">.</span><span class="token constant">RETRY_BACKOFF_MS_CONFIG</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è®¾ç½®å‘é€æ¶ˆæ¯çš„æœ¬åœ°ç¼“å†²åŒºï¼Œå¦‚æœè®¾ç½®äº†è¯¥ç¼“å†²åŒºï¼Œæ¶ˆæ¯ä¼šå…ˆå‘é€åˆ°æœ¬åœ°ç¼“å†²åŒºï¼Œå¯ä»¥æé«˜æ¶ˆæ¯å‘é€æ€§èƒ½ï¼Œé»˜è®¤å€¼æ˜¯33554432ï¼Œå³32MB</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ProducerConfig</span><span class="token punctuation">.</span><span class="token constant">BUFFER_MEMORY_CONFIG</span><span class="token punctuation">,</span> <span class="token number">33554432</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">*</span><span class="token comment">//*</span>
        kafkaæœ¬åœ°çº¿ç¨‹ä¼šä»ç¼“å†²åŒºå–æ•°æ®ï¼Œæ‰¹é‡å‘é€åˆ°brokerï¼Œ
        è®¾ç½®æ‰¹é‡å‘é€æ¶ˆæ¯çš„å¤§å°ï¼Œé»˜è®¤å€¼æ˜¯<span class="token number">16384</span>ï¼Œå³<span class="token number">16</span>kbï¼Œå°±æ˜¯è¯´ä¸€ä¸ªbatchæ»¡äº†<span class="token number">16</span>kbå°±å‘é€å‡ºå»
        <span class="token operator">*</span><span class="token comment">//*</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ProducerConfig</span><span class="token punctuation">.</span><span class="token constant">BATCH_SIZE_CONFIG</span><span class="token punctuation">,</span> <span class="token number">16384</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">*</span><span class="token comment">//*</span>
        é»˜è®¤å€¼æ˜¯<span class="token number">0</span>ï¼Œæ„æ€å°±æ˜¯æ¶ˆæ¯å¿…é¡»ç«‹å³è¢«å‘é€ï¼Œä½†è¿™æ ·ä¼šå½±å“æ€§èƒ½
        ä¸€èˆ¬è®¾ç½®<span class="token number">10</span>æ¯«ç§’å·¦å³ï¼Œå°±æ˜¯è¯´è¿™ä¸ªæ¶ˆæ¯å‘é€å®Œåä¼šè¿›å…¥æœ¬åœ°çš„ä¸€ä¸ªbatchï¼Œå¦‚æœ<span class="token number">10</span>æ¯«ç§’å†…ï¼Œè¿™ä¸ªbatchæ»¡äº†<span class="token number">16</span>kbå°±ä¼šéšbatchä¸€èµ·è¢«å‘é€å‡ºå»
        å¦‚æœ<span class="token number">10</span>æ¯«ç§’å†…ï¼Œbatchæ²¡æ»¡ï¼Œé‚£ä¹ˆä¹Ÿå¿…é¡»æŠŠæ¶ˆæ¯å‘é€å‡ºå»ï¼Œä¸èƒ½è®©æ¶ˆæ¯çš„å‘é€å»¶è¿Ÿæ—¶é—´å¤ªé•¿
        <span class="token operator">*</span><span class="token comment">//*</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ProducerConfig</span><span class="token punctuation">.</span><span class="token constant">LINGER_MS_CONFIG</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">*</span><span class="token operator">/</span>
        <span class="token comment">//æŠŠå‘é€çš„keyä»å­—ç¬¦ä¸²åºåˆ—åŒ–ä¸ºå­—èŠ‚æ•°ç»„</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ProducerConfig</span><span class="token punctuation">.</span><span class="token constant">KEY_SERIALIZER_CLASS_CONFIG</span><span class="token punctuation">,</span> <span class="token class-name">StringSerializer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æŠŠå‘é€æ¶ˆæ¯valueä»å­—ç¬¦ä¸²åºåˆ—åŒ–ä¸ºå­—èŠ‚æ•°ç»„</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ProducerConfig</span><span class="token punctuation">.</span><span class="token constant">VALUE_SERIALIZER_CLASS_CONFIG</span><span class="token punctuation">,</span> <span class="token class-name">StringSerializer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Producer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> producer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">KafkaProducer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">int</span> msgNum <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token class-name">CountDownLatch</span> countDownLatch <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CountDownLatch</span><span class="token punctuation">(</span>msgNum<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> msgNum<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Order</span> order <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Order</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">100</span> <span class="token operator">+</span> i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1000.00</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//æŒ‡å®šå‘é€åˆ†åŒº</span>
            <span class="token comment">/*ProducerRecord&lt;String, String&gt; producerRecord = new ProducerRecord&lt;String, String&gt;(TOPIC_NAME
                    , 0, order.getOrderId().toString(), JSON.toJSONString(order));*/</span>
            <span class="token comment">//æœªæŒ‡å®šå‘é€åˆ†åŒºï¼Œå…·ä½“å‘é€çš„åˆ†åŒºè®¡ç®—å…¬å¼ï¼šhash(key)%partitionNum</span>
            <span class="token class-name">ProducerRecord</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> producerRecord <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ProducerRecord</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token constant">TOPIC_NAME</span>
                    <span class="token punctuation">,</span> order<span class="token punctuation">.</span><span class="token function">getOrderId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//ç­‰å¾…æ¶ˆæ¯å‘é€æˆåŠŸçš„åŒæ­¥é˜»å¡æ–¹æ³•</span>
            <span class="token comment">/*RecordMetadata metadata = producer.send(producerRecord).get();
            System.out.println(&quot;åŒæ­¥æ–¹å¼å‘é€æ¶ˆæ¯ç»“æœï¼š&quot; + &quot;topic-&quot; + metadata.topic() + &quot;|partition-&quot;
                    + metadata.partition() + &quot;|offset-&quot; + metadata.offset());*/</span>

            <span class="token comment">//å¼‚æ­¥å›è°ƒæ–¹å¼å‘é€æ¶ˆæ¯</span>
            producer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>producerRecord<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCompletion</span><span class="token punctuation">(</span><span class="token class-name">RecordMetadata</span> metadata<span class="token punctuation">,</span> <span class="token class-name">Exception</span> exception<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>exception <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å‘é€æ¶ˆæ¯å¤±è´¥ï¼š&quot;</span> <span class="token operator">+</span> exception<span class="token punctuation">.</span><span class="token function">getStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token punctuation">}</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>metadata <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å¼‚æ­¥æ–¹å¼å‘é€æ¶ˆæ¯ç»“æœï¼š&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;topic-&quot;</span> <span class="token operator">+</span> metadata<span class="token punctuation">.</span><span class="token function">topic</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;|partition-&quot;</span>
                                <span class="token operator">+</span> metadata<span class="token punctuation">.</span><span class="token function">partition</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;|offset-&quot;</span> <span class="token operator">+</span> metadata<span class="token punctuation">.</span><span class="token function">offset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    countDownLatch<span class="token punctuation">.</span><span class="token function">countDown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//é€ç§¯åˆ† TODO</span>

        <span class="token punctuation">}</span>

        countDownLatch<span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        producer<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ¶ˆæ¯æ¥æ”¶ç«¯ä»£ç </strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tuling<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>kafkaDemo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>consumer<span class="token punctuation">.</span></span><span class="token class-name">ConsumerConfig</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>consumer<span class="token punctuation">.</span></span><span class="token class-name">ConsumerRecord</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>consumer<span class="token punctuation">.</span></span><span class="token class-name">ConsumerRecords</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>consumer<span class="token punctuation">.</span></span><span class="token class-name">KafkaConsumer</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>common<span class="token punctuation">.</span>serialization<span class="token punctuation">.</span></span><span class="token class-name">StringDeserializer</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">Duration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Arrays</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Properties</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MsgConsumer</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token constant">TOPIC_NAME</span> <span class="token operator">=</span> <span class="token string">&quot;my-replicated-topic&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token constant">CONSUMER_GROUP_NAME</span> <span class="token operator">=</span> <span class="token string">&quot;testGroup&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Properties</span> props <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ConsumerConfig</span><span class="token punctuation">.</span><span class="token constant">BOOTSTRAP_SERVERS_CONFIG</span><span class="token punctuation">,</span> <span class="token string">&quot;192.168.65.60:9092,192.168.65.60:9093,192.168.65.60:9094&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æ¶ˆè´¹åˆ†ç»„å</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ConsumerConfig</span><span class="token punctuation">.</span><span class="token constant">GROUP_ID_CONFIG</span><span class="token punctuation">,</span> <span class="token constant">CONSUMER_GROUP_NAME</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æ˜¯å¦è‡ªåŠ¨æäº¤offsetï¼Œé»˜è®¤å°±æ˜¯true</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ConsumerConfig</span><span class="token punctuation">.</span><span class="token constant">ENABLE_AUTO_COMMIT_CONFIG</span><span class="token punctuation">,</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è‡ªåŠ¨æäº¤offsetçš„é—´éš”æ—¶é—´</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ConsumerConfig</span><span class="token punctuation">.</span><span class="token constant">AUTO_COMMIT_INTERVAL_MS_CONFIG</span><span class="token punctuation">,</span> <span class="token string">&quot;1000&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//props.put(ConsumerConfig.ENABLE_AUTO_COMMIT_CONFIG, &quot;false&quot;);</span>
        <span class="token comment">/*
        å½“æ¶ˆè´¹ä¸»é¢˜çš„æ˜¯ä¸€ä¸ªæ–°çš„æ¶ˆè´¹ç»„ï¼Œæˆ–è€…æŒ‡å®šoffsetçš„æ¶ˆè´¹æ–¹å¼ï¼Œoffsetä¸å­˜åœ¨ï¼Œé‚£ä¹ˆåº”è¯¥å¦‚ä½•æ¶ˆè´¹
        latest(é»˜è®¤) ï¼šåªæ¶ˆè´¹è‡ªå·±å¯åŠ¨ä¹‹åå‘é€åˆ°ä¸»é¢˜çš„æ¶ˆæ¯
        earliestï¼šç¬¬ä¸€æ¬¡ä»å¤´å¼€å§‹æ¶ˆè´¹ï¼Œä»¥åæŒ‰ç…§æ¶ˆè´¹offsetè®°å½•ç»§ç»­æ¶ˆè´¹ï¼Œè¿™ä¸ªéœ€è¦åŒºåˆ«äºconsumer.seekToBeginning(æ¯æ¬¡éƒ½ä»å¤´å¼€å§‹æ¶ˆè´¹)
        */</span>
        <span class="token comment">//props.put(ConsumerConfig.AUTO_OFFSET_RESET_CONFIG, &quot;earliest&quot;);</span>
      <span class="token comment">/*
      consumerç»™brokerå‘é€å¿ƒè·³çš„é—´éš”æ—¶é—´ï¼Œbrokeræ¥æ”¶åˆ°å¿ƒè·³å¦‚æœæ­¤æ—¶æœ‰rebalanceå‘ç”Ÿä¼šé€šè¿‡å¿ƒè·³å“åº”å°†
      rebalanceæ–¹æ¡ˆä¸‹å‘ç»™consumerï¼Œè¿™ä¸ªæ—¶é—´å¯ä»¥ç¨å¾®çŸ­ä¸€ç‚¹
      */</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ConsumerConfig</span><span class="token punctuation">.</span><span class="token constant">HEARTBEAT_INTERVAL_MS_CONFIG</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">/*
        æœåŠ¡ç«¯brokerå¤šä¹…æ„ŸçŸ¥ä¸åˆ°ä¸€ä¸ªconsumerå¿ƒè·³å°±è®¤ä¸ºä»–æ•…éšœäº†ï¼Œä¼šå°†å…¶è¸¢å‡ºæ¶ˆè´¹ç»„ï¼Œ
        å¯¹åº”çš„Partitionä¹Ÿä¼šè¢«é‡æ–°åˆ†é…ç»™å…¶ä»–consumerï¼Œé»˜è®¤æ˜¯10ç§’
        */</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ConsumerConfig</span><span class="token punctuation">.</span><span class="token constant">SESSION_TIMEOUT_MS_CONFIG</span><span class="token punctuation">,</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//ä¸€æ¬¡pollæœ€å¤§æ‹‰å–æ¶ˆæ¯çš„æ¡æ•°ï¼Œå¦‚æœæ¶ˆè´¹è€…å¤„ç†é€Ÿåº¦å¾ˆå¿«ï¼Œå¯ä»¥è®¾ç½®å¤§ç‚¹ï¼Œå¦‚æœå¤„ç†é€Ÿåº¦ä¸€èˆ¬ï¼Œå¯ä»¥è®¾ç½®å°ç‚¹</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ConsumerConfig</span><span class="token punctuation">.</span><span class="token constant">MAX_POLL_RECORDS_CONFIG</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">/*
        å¦‚æœä¸¤æ¬¡pollæ“ä½œé—´éš”è¶…è¿‡äº†è¿™ä¸ªæ—¶é—´ï¼Œbrokerå°±ä¼šè®¤ä¸ºè¿™ä¸ªconsumerå¤„ç†èƒ½åŠ›å¤ªå¼±ï¼Œ
        ä¼šå°†å…¶è¸¢å‡ºæ¶ˆè´¹ç»„ï¼Œå°†åˆ†åŒºåˆ†é…ç»™åˆ«çš„consumeræ¶ˆè´¹
        */</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ConsumerConfig</span><span class="token punctuation">.</span><span class="token constant">MAX_POLL_INTERVAL_MS_CONFIG</span><span class="token punctuation">,</span> <span class="token number">30</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ConsumerConfig</span><span class="token punctuation">.</span><span class="token constant">KEY_DESERIALIZER_CLASS_CONFIG</span><span class="token punctuation">,</span> <span class="token class-name">StringDeserializer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        props<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">ConsumerConfig</span><span class="token punctuation">.</span><span class="token constant">VALUE_DESERIALIZER_CLASS_CONFIG</span><span class="token punctuation">,</span> <span class="token class-name">StringDeserializer</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">KafkaConsumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> consumer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">KafkaConsumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>

        consumer<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token constant">TOPIC_NAME</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æ¶ˆè´¹æŒ‡å®šåˆ†åŒº</span>
        <span class="token comment">//consumer.assign(Arrays.asList(new TopicPartition(TOPIC_NAME, 0)));</span>

        <span class="token comment">//æ¶ˆæ¯å›æº¯æ¶ˆè´¹</span>
        <span class="token comment">/*consumer.assign(Arrays.asList(new TopicPartition(TOPIC_NAME, 0)));
        consumer.seekToBeginning(Arrays.asList(new TopicPartition(TOPIC_NAME, 0)));*/</span>

        <span class="token comment">//æŒ‡å®šoffsetæ¶ˆè´¹</span>
        <span class="token comment">/*consumer.assign(Arrays.asList(new TopicPartition(TOPIC_NAME, 0)));
        consumer.seek(new TopicPartition(TOPIC_NAME, 0), 10);*/</span>

        <span class="token comment">//ä»æŒ‡å®šæ—¶é—´ç‚¹å¼€å§‹æ¶ˆè´¹</span>
        <span class="token comment">/*List&lt;PartitionInfo&gt; topicPartitions = consumer.partitionsFor(TOPIC_NAME);
        //ä»1å°æ—¶å‰å¼€å§‹æ¶ˆè´¹
        long fetchDataTime = new Date().getTime() - 1000 * 60 * 60;
        Map&lt;TopicPartition, Long&gt; map = new HashMap&lt;&gt;();
        for (PartitionInfo par : topicPartitions) {
            map.put(new TopicPartition(topicName, par.partition()), fetchDataTime);
        }
        Map&lt;TopicPartition, OffsetAndTimestamp&gt; parMap = consumer.offsetsForTimes(map);
        for (Map.Entry&lt;TopicPartition, OffsetAndTimestamp&gt; entry : parMap.entrySet()) {
            TopicPartition key = entry.getKey();
            OffsetAndTimestamp value = entry.getValue();
            if (key == null || value == null) continue;
            Long offset = value.offset();
            System.out.println(&quot;partition-&quot; + key.partition() + &quot;|offset-&quot; + offset);
            System.out.println();
            //æ ¹æ®æ¶ˆè´¹é‡Œçš„timestampç¡®å®šoffset
            if (value != null) {
                consumer.assign(Arrays.asList(key));
                consumer.seek(key, offset);
            }
        }*/</span>

        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">/*
             * poll() API æ˜¯æ‹‰å–æ¶ˆæ¯çš„é•¿è½®è¯¢
             */</span>
            <span class="token class-name">ConsumerRecords</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> records <span class="token operator">=</span> consumer<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofMillis</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ConsumerRecord</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> record <span class="token operator">:</span> records<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;æ”¶åˆ°æ¶ˆæ¯ï¼špartition = %d,offset = %d, key = %s, value = %s%n&quot;</span><span class="token punctuation">,</span> record<span class="token punctuation">.</span><span class="token function">partition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        record<span class="token punctuation">.</span><span class="token function">offset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> record<span class="token punctuation">.</span><span class="token function">key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> record<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">/*if (records.count() &gt; 0) {
                // æ‰‹åŠ¨åŒæ­¥æäº¤offsetï¼Œå½“å‰çº¿ç¨‹ä¼šé˜»å¡ç›´åˆ°offsetæäº¤æˆåŠŸ
                // ä¸€èˆ¬ä½¿ç”¨åŒæ­¥æäº¤ï¼Œå› ä¸ºæäº¤ä¹‹åä¸€èˆ¬ä¹Ÿæ²¡æœ‰ä»€ä¹ˆé€»è¾‘ä»£ç äº†
                consumer.commitSync();

                // æ‰‹åŠ¨å¼‚æ­¥æäº¤offsetï¼Œå½“å‰çº¿ç¨‹æäº¤offsetä¸ä¼šé˜»å¡ï¼Œå¯ä»¥ç»§ç»­å¤„ç†åé¢çš„ç¨‹åºé€»è¾‘
                consumer.commitAsync(new OffsetCommitCallback() {
                    @Override
                    public void onComplete(Map&lt;TopicPartition, OffsetAndMetadata&gt; offsets, Exception exception) {
                        if (exception != null) {
                            System.err.println(&quot;Commit failed for &quot; + offsets);
                            System.err.println(&quot;Commit failed exception: &quot; + exception.getStackTrace());
                        }
                    }
                });

            }*/</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Spring Bootæ•´åˆKafka</strong></p><p>å¼•å…¥spring boot kafkaä¾èµ–ï¼Œè¯¦è§é¡¹ç›®å®ä¾‹ï¼šspring-boot-kafka</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.kafka<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-kafka<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>       
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>application.ymlé…ç½®å¦‚ä¸‹ï¼š</strong></p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8080</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">kafka</span><span class="token punctuation">:</span>
    <span class="token key atrule">bootstrap-servers</span><span class="token punctuation">:</span> 192.168.65.60<span class="token punctuation">:</span><span class="token number">9092</span><span class="token punctuation">,</span>192.168.65.60<span class="token punctuation">:</span><span class="token number">9093</span><span class="token punctuation">,</span>192.168.65.60<span class="token punctuation">:</span><span class="token number">9094</span>
    <span class="token key atrule">producer</span><span class="token punctuation">:</span> <span class="token comment"># ç”Ÿäº§è€…</span>
      <span class="token key atrule">retries</span><span class="token punctuation">:</span> <span class="token number">3</span> <span class="token comment"># è®¾ç½®å¤§äº0çš„å€¼ï¼Œåˆ™å®¢æˆ·ç«¯ä¼šå°†å‘é€å¤±è´¥çš„è®°å½•é‡æ–°å‘é€</span>
      <span class="token key atrule">batch-size</span><span class="token punctuation">:</span> <span class="token number">16384</span>
      <span class="token key atrule">buffer-memory</span><span class="token punctuation">:</span> <span class="token number">33554432</span>
      <span class="token key atrule">acks</span><span class="token punctuation">:</span> <span class="token number">1</span>
      <span class="token comment"># æŒ‡å®šæ¶ˆæ¯keyå’Œæ¶ˆæ¯ä½“çš„ç¼–è§£ç æ–¹å¼</span>
      <span class="token key atrule">key-serializer</span><span class="token punctuation">:</span> org.apache.kafka.common.serialization.StringSerializer
      <span class="token key atrule">value-serializer</span><span class="token punctuation">:</span> org.apache.kafka.common.serialization.StringSerializer
    <span class="token key atrule">consumer</span><span class="token punctuation">:</span>
      <span class="token key atrule">group-id</span><span class="token punctuation">:</span> default<span class="token punctuation">-</span>group
      <span class="token key atrule">enable-auto-commit</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
      <span class="token key atrule">auto-offset-reset</span><span class="token punctuation">:</span> earliest
      <span class="token key atrule">key-deserializer</span><span class="token punctuation">:</span> org.apache.kafka.common.serialization.StringDeserializer
      <span class="token key atrule">value-deserializer</span><span class="token punctuation">:</span> org.apache.kafka.common.serialization.StringDeserializer
    <span class="token key atrule">listener</span><span class="token punctuation">:</span>
      <span class="token comment"># å½“æ¯ä¸€æ¡è®°å½•è¢«æ¶ˆè´¹è€…ç›‘å¬å™¨ï¼ˆListenerConsumerï¼‰å¤„ç†ä¹‹åæäº¤</span>
      <span class="token comment"># RECORD</span>
      <span class="token comment"># å½“æ¯ä¸€æ‰¹poll()çš„æ•°æ®è¢«æ¶ˆè´¹è€…ç›‘å¬å™¨ï¼ˆListenerConsumerï¼‰å¤„ç†ä¹‹åæäº¤</span>
      <span class="token comment"># BATCH</span>
      <span class="token comment"># å½“æ¯ä¸€æ‰¹poll()çš„æ•°æ®è¢«æ¶ˆè´¹è€…ç›‘å¬å™¨ï¼ˆListenerConsumerï¼‰å¤„ç†ä¹‹åï¼Œè·ç¦»ä¸Šæ¬¡æäº¤æ—¶é—´å¤§äºTIMEæ—¶æäº¤</span>
      <span class="token comment"># TIME</span>
      <span class="token comment"># å½“æ¯ä¸€æ‰¹poll()çš„æ•°æ®è¢«æ¶ˆè´¹è€…ç›‘å¬å™¨ï¼ˆListenerConsumerï¼‰å¤„ç†ä¹‹åï¼Œè¢«å¤„ç†recordæ•°é‡å¤§äºç­‰äºCOUNTæ—¶æäº¤</span>
      <span class="token comment"># COUNT</span>
      <span class="token comment"># TIME |ã€€COUNTã€€æœ‰ä¸€ä¸ªæ¡ä»¶æ»¡è¶³æ—¶æäº¤</span>
      <span class="token comment"># COUNT_TIME</span>
      <span class="token comment"># å½“æ¯ä¸€æ‰¹poll()çš„æ•°æ®è¢«æ¶ˆè´¹è€…ç›‘å¬å™¨ï¼ˆListenerConsumerï¼‰å¤„ç†ä¹‹å, æ‰‹åŠ¨è°ƒç”¨Acknowledgment.acknowledge()åæäº¤</span>
      <span class="token comment"># MANUAL</span>
      <span class="token comment"># æ‰‹åŠ¨è°ƒç”¨Acknowledgment.acknowledge()åç«‹å³æäº¤ï¼Œä¸€èˆ¬ä½¿ç”¨è¿™ç§</span>
      <span class="token comment"># MANUAL_IMMEDIATE</span>
      <span class="token key atrule">ack-mode</span><span class="token punctuation">:</span> manual_immediate          
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å‘é€è€…ä»£ç ï¼š</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>kafka</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">KafkaTemplate</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">KafkaController</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token constant">TOPIC_NAME</span> <span class="token operator">=</span> <span class="token string">&quot;my-replicated-topic&quot;</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">KafkaTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> kafkaTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/send&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        kafkaTemplate<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token constant">TOPIC_NAME</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&quot;key&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;this is a msg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>       
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ¶ˆè´¹è€…ä»£ç ï¼š</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>kafka</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>clients<span class="token punctuation">.</span>consumer<span class="token punctuation">.</span></span><span class="token class-name">ConsumerRecord</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">KafkaListener</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>kafka<span class="token punctuation">.</span>support<span class="token punctuation">.</span></span><span class="token class-name">Acknowledgment</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Component</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyConsumer</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * @KafkaListener(groupId = &quot;testGroup&quot;, topicPartitions = <span class="token punctuation">{</span>
     *             @TopicPartition(topic = &quot;topic1&quot;, partitions = <span class="token punctuation">{</span>&quot;0&quot;, &quot;1&quot;<span class="token punctuation">}</span>),
     *             @TopicPartition(topic = &quot;topic2&quot;, partitions = &quot;0&quot;,
     *                     partitionOffsets = @PartitionOffset(partition = &quot;1&quot;, initialOffset = &quot;100&quot;))
     *     <span class="token punctuation">}</span>,concurrency = &quot;6&quot;)
     *  //concurrencyå°±æ˜¯åŒç»„ä¸‹çš„æ¶ˆè´¹è€…ä¸ªæ•°ï¼Œå°±æ˜¯å¹¶å‘æ¶ˆè´¹æ•°ï¼Œå¿…é¡»å°äºç­‰äºåˆ†åŒºæ€»æ•°
     * <span class="token keyword">@param</span> <span class="token parameter">record</span>
     */</span>
    <span class="token annotation punctuation">@KafkaListener</span><span class="token punctuation">(</span>topics <span class="token operator">=</span> <span class="token string">&quot;my-replicated-topic&quot;</span><span class="token punctuation">,</span>groupId <span class="token operator">=</span> <span class="token string">&quot;zhugeGroup&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">listenZhugeGroup</span><span class="token punctuation">(</span><span class="token class-name">ConsumerRecord</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> record<span class="token punctuation">,</span> <span class="token class-name">Acknowledgment</span> ack<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> value <span class="token operator">=</span> record<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ‰‹åŠ¨æäº¤offset</span>
        ack<span class="token punctuation">.</span><span class="token function">acknowledge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/*//é…ç½®å¤šä¸ªæ¶ˆè´¹ç»„
    @KafkaListener(topics = &quot;my-replicated-topic&quot;,groupId = &quot;tulingGroup&quot;)
    public void listenTulingGroup(ConsumerRecord&lt;String, String&gt; record, Acknowledgment ack) {
        String value = record.value();
        System.out.println(value);
        System.out.println(record);
        ack.acknowledge();
    }*/</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â€‹</p></div><!----><footer class="page-meta"><!----><div class="meta-item git-info"><div class="update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: thejqd@gmail.com">jiangqingdong</span><!--]--><!--]--></div></div></footer><!----><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper"><!----><div class="copyright">Copyright Â© 2023 æ±Ÿ</div></footer></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app-c8395efa.js" defer></script>
  </body>
</html>
